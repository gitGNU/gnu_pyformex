

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"> 
<!-- 
##
##  This file is part of the pyFormex project.
##  pyFormex is a tool for generating, manipulating and transforming 3D
##  geometrical models by sequences of mathematical operations.
##  Home page: http://pyformex.org
##  Project page:  http://savannah.nongnu.org/projects/pyformex/
##  Copyright (C) Benedict Verhegghe (benedict.verhegghe@ugent.be) 
##  Distributed under the GNU General Public License version 3 or later.
##
##
##  This program is free software: you can redistribute it and/or modify
##  it under the terms of the GNU General Public License as published by
##  the Free Software Foundation, either version 3 of the License, or
##  (at your option) any later version.
##
##  This program is distributed in the hope that it will be useful,
##  but WITHOUT ANY WARRANTY; without even the implied warranty of
##  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
##  GNU General Public License for more details.
##
##  You should have received a copy of the GNU General Public License
##  along with this program.  If not, see http://www.gnu.org/licenses/.
##
-->


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>18. geomtools — Basic geometrical operations. &mdash; pyFormex 1.0.2~a1 documentation</title>

    
    <link rel="stylesheet" href="../_static/pyformex.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '1.0.2~a1',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  false
      };
    </script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <link rel="top" title="pyFormex 1.0.2~a1 documentation" href="../index.html" />
    <link rel="up" title="pyFormex reference manual" href="../refman.html" />
    <link rel="next" title="19. inertia — Compute inertia related quantities of geometrical models." href="inertia.html" />
    <link rel="prev" title="17. geomfile — Handling pyFormex Geometry Files" href="geomfile.html" />
<link rel="icon" type="image/png" href="_static/pyformex_fav.png" />

  </head>
  <body>

<div class="header">
  <a href="http://pyformex.org">
  <img src="http://www.nongnu.org/pyformex/_static/scallop_dome_small.png" alt="scallop dome" border="0" hspace="20" vspace="12" align="left" />
  <img src="http://www.nongnu.org/pyformex/_static/pyformex-logo-2.png" alt="pyformex logo" border="0" hspace="10" vspace="8" align="left" />
  </a>
</div>

    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="inertia.html" title="19. inertia — Compute inertia related quantities of geometrical models."
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="geomfile.html" title="17. geomfile — Handling pyFormex Geometry Files"
             accesskey="P">previous</a> |</li>
        <li><a href="../index.html">pyFormex 1.0.2~a1 documentation</a> &gt;</li>
          <li><a href="../refman.html" accesskey="U">pyFormex reference manual</a> &gt;</li> 
      </ul>
    </div>
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
<div align="center">

<form action="https://www.paypal.com/cgi-bin/webscr" method="post">
<input type="hidden" name="cmd" value="_s-xclick"/>
<input type="hidden" name="hosted_button_id" value="P7J4AM4QULB4Q"/>
<input type="image" src="https://www.paypal.com/en_US/BE/i/btn/btn_donateCC_LG.gif" name="submit" alt="PayPal - The safer, easier way to pay online!"/>
<img alt="" border="0" src="https://www.paypal.com/nl_NL/i/scr/pixel.gif" width="1" height="1"/>
</form>

</div>
   
  <h3><a href="../index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">18. <tt class="docutils literal"><span class="pre">geomtools</span></tt> &#8212; Basic geometrical operations.</a><ul>
<li><a class="reference internal" href="#classes-defined-in-module-geomtools">18.1. Classes defined in module geomtools</a></li>
<li><a class="reference internal" href="#functions-defined-in-module-geomtools">18.2. Functions defined in module geomtools</a></li>
</ul>
</li>
</ul>


  <h4>Previous topic</h4>
  <p class="topless"><a href="geomfile.html"
                        title="previous chapter">17. <tt class="docutils literal"><span class="pre">geomfile</span></tt> &#8212; Handling pyFormex Geometry Files</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="inertia.html"
                        title="next chapter">19. <tt class="docutils literal"><span class="pre">inertia</span></tt> &#8212; Compute inertia related quantities of geometrical models.</a></p>
  
<div id="searchbox" style="display: none">
  <h3>Quick search</h3>
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>

<div align="center">
  <p>
  <a href="http://www.fsf.org/register_form?referrer=8491"><img src="http://www.nongnu.org/pyformex/_static/fsf-member8491.png" alt="[FSF Associate Member]" width="89" height="31"  /></a>
  </p>
  <p>
    <a href="http://validator.w3.org/check?uri=referer"><img
      src="http://www.w3.org/Icons/valid-xhtml10" alt="Valid XHTML 1.0 Transitional" height="31" width="88" /></a>
  </p>
</div>

        </div>
      </div>

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <div class="section" id="module-geomtools">
<span id="geomtools-basic-geometrical-operations"></span><span id="sec-ref-geomtools"></span><h1>18. <a class="reference internal" href="#module-geomtools" title="geomtools: Basic geometrical operations."><tt class="xref py py-mod docutils literal"><span class="pre">geomtools</span></tt></a> &#8212; Basic geometrical operations.<a class="headerlink" href="#module-geomtools" title="Permalink to this headline">¶</a></h1>
<p>This module defines some basic operations on simple geometrical entities
such as points, lines, planes, vectors, segments, triangles, circles.</p>
<p>The operations include intersection, projection, distance computing.</p>
<p>Many of the functions in this module are exported as methods on the
Coords and Geometry classes and subclasses.</p>
<p>Planned renaming of functions:</p>
<div class="highlight-python"><div class="highlight"><pre>areaNormals
degenerate
levelVolumes
smallestDirection
distance                 -&gt; distance
closest
closestPair
projectedArea
polygonNormals
averageNormals
triangleInCircle
triangleCircumCircle
triangleBoundingCircle
triangleObtuse
lineIntersection         -&gt; to be removed (or intersect2DLineWithLine)
displaceLines
segmentOrientation
rotationAngle
anyPerpendicularVector
perpendicularVector
projectionVOV            -&gt; projectVectorOnVector
projectionVOP            -&gt; projectVectorOnPlane

pointsAtLines            -&gt; pointOnLine
pointsAtSegments         -&gt; pointOnSegment
intersectionTimesSWP     -&gt; remove or intersectLineWithLineTimes2
intersectionSWP          -&gt; intersectSegmentWithPlaneTimes
intersectionPointsSWP    -&gt; intersectSegmentWithPlane
intersectionTimesLWT     -&gt; intersectLineWithTriangleTimes
intersectionPointsLWT    -&gt; intersectLineWithTriangle
intersectionTimesSWT     -&gt; intersectSegmentWithTriangleTimes
intersectionPointsSWT    -&gt; intersectSegmentWithTriangle
intersectionPointsPWP    -&gt; intersectThreePlanes
intersectionLinesPWP     -&gt; intersectTwoPlanes (or intersectPlaneWithPlane)
intersectionSphereSphere -&gt; intersectTwoSpheres (or intersectSphereWithSphere)

faceDistance             -&gt;
edgeDistance             -&gt;
vertexDistance           -&gt;
baryCoords
insideSimplex
insideTriangle
</pre></div>
</div>
<div class="section" id="classes-defined-in-module-geomtools">
<h2>18.1. Classes defined in module geomtools<a class="headerlink" href="#classes-defined-in-module-geomtools" title="Permalink to this headline">¶</a></h2>
</div>
<div class="section" id="functions-defined-in-module-geomtools">
<h2>18.2. Functions defined in module geomtools<a class="headerlink" href="#functions-defined-in-module-geomtools" title="Permalink to this headline">¶</a></h2>
<dl class="function">
<dt id="geomtools.pointsAtLines">
<tt class="descclassname">geomtools.</tt><tt class="descname">pointsAtLines</tt><big>(</big><em>q</em>, <em>m</em>, <em>t</em><big>)</big><a class="headerlink" href="#geomtools.pointsAtLines" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the points of lines (q,m) at parameter values t.</p>
<p>Parameters:</p>
<ul class="simple">
<li><cite>q</cite>,`m`: (...,3) shaped arrays of points and vectors, defining
a single line or a set of lines. The vectors do not need to
have unit length.</li>
<li><cite>t</cite>: array of parameter values, broadcast compatible with <cite>q</cite> and <cite>m</cite>.
Parametric value 0 is at point q, parametric value 1 ia at q+m.</li>
</ul>
<p>Returns a Coords array with the points at parameter values t.</p>
</dd></dl>

<dl class="function">
<dt id="geomtools.pointsAtSegments">
<tt class="descclassname">geomtools.</tt><tt class="descname">pointsAtSegments</tt><big>(</big><em>S</em>, <em>t</em><big>)</big><a class="headerlink" href="#geomtools.pointsAtSegments" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the points of line segments S at parameter values t.</p>
<p>Parameters:</p>
<ul class="simple">
<li><cite>S</cite>: (...,2,3) shaped array, defining a single line segment or
a set of line segments.</li>
<li><cite>t</cite>: array of parameter values, broadcast compatible with <cite>S</cite>.</li>
</ul>
<p>Returns an array with the points at parameter values t.</p>
</dd></dl>

<dl class="function">
<dt id="geomtools.intersectLineWithLine">
<tt class="descclassname">geomtools.</tt><tt class="descname">intersectLineWithLine</tt><big>(</big><em>q1</em>, <em>m1</em>, <em>q2</em>, <em>m2</em>, <em>mode='all'</em>, <em>times=False</em><big>)</big><a class="headerlink" href="#geomtools.intersectLineWithLine" title="Permalink to this definition">¶</a></dt>
<dd><p>Find the common perpendicular of lines (q1,m1) and lines (q2,m2)</p>
<p>Return the intersection points of lines (q1,m1) and lines (q2,m2)
with the perpendiculars between them. For intersecting lines, the
corresponding points will coincide.</p>
<p>Parameters:</p>
<ul class="simple">
<li><cite>qi</cite>,`mi` (i=1,2): (nqi,3) shaped arrays of points and vectors defining
nqi lines.</li>
<li><cite>mode</cite>: &#8216;all&#8217; or &#8216;pair:<ul>
<li>if &#8216;all&#8217;, the interesection of all lines q1,m1 with all lines q2,m2
is computed; <cite>nq1</cite> and <cite>nq2</cite> can be different.</li>
<li>if &#8216;pair&#8217;: <cite>nq1</cite> and <cite>nq2</cite> should be equal (or 1) and the intersection
of pairs of lines are computed (using broadcasting for
length 1 data).</li>
</ul>
</li>
<li><cite>times</cite>: bool: if True, returns the parameter values of the
intersection points instead of the intersection points themselves.</li>
</ul>
<p>Returns two Coords arrays with the intersection points on lines (q1,m1)
and (q2,m2) respectively (or, if <cite>times</cite> is True, two float arrays
with the parameter values of these points).
The size of the Coords arrays is (nq1,nq2,3) for mode &#8216;all&#8217; and (nq1,3)
for mode &#8216;pair&#8217;. With <cite>times</cite> True, the size of the returned parameter
arrays is (nq1,nq2,3) for mode &#8216;all&#8217; and size (nq1,3) for mode &#8216;pair&#8217;.</p>
<p>Note: taking the intersection of two parallel lines will result in
nan values. These are not removed from the result. The user can do
it if he so wishes.</p>
<p>Example:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">q</span><span class="p">,</span><span class="n">m</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">],[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">3</span><span class="p">]],</span> <span class="p">[[</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">],[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">]]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">p</span><span class="p">,</span><span class="n">n</span> <span class="o">=</span> <span class="p">[[</span><span class="mf">2.</span><span class="p">,</span><span class="mf">0.</span><span class="p">,</span><span class="mf">0.</span><span class="p">],[</span><span class="mf">0.</span><span class="p">,</span><span class="mf">0.</span><span class="p">,</span><span class="mf">0.</span><span class="p">]],</span> <span class="p">[[</span><span class="mf">0.</span><span class="p">,</span><span class="mf">1.</span><span class="p">,</span><span class="mf">0.</span><span class="p">],[</span><span class="mf">0.</span><span class="p">,</span><span class="mf">0.</span><span class="p">,</span><span class="mf">1.</span><span class="p">]]</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">x1</span><span class="p">,</span><span class="n">x2</span> <span class="o">=</span> <span class="n">intersectLineWithLine</span><span class="p">(</span><span class="n">q</span><span class="p">,</span><span class="n">m</span><span class="p">,</span><span class="n">p</span><span class="p">,</span><span class="n">n</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">x1</span><span class="p">)</span>
<span class="go">[[[  2.   0.   0.]</span>
<span class="go">  [  0.   0.   0.]]</span>

<span class="go"> [[  2.   2.   1.]</span>
<span class="go">  [  0.   0.   1.]]</span>

<span class="go"> [[ nan  nan  nan]</span>
<span class="go">  [  0.   0.   3.]]]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">x2</span><span class="p">)</span>
<span class="go">[[[  2.   0.   0.]</span>
<span class="go">  [  0.   0.   0.]]</span>

<span class="go"> [[  2.   2.   0.]</span>
<span class="go">  [  0.   0.   1.]]</span>

<span class="go"> [[ nan  nan  nan]</span>
<span class="go">  [  0.   0.   3.]]]</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">x1</span><span class="p">,</span><span class="n">x2</span> <span class="o">=</span> <span class="n">intersectLineWithLine</span><span class="p">(</span><span class="n">q</span><span class="p">[:</span><span class="mi">2</span><span class="p">],</span><span class="n">m</span><span class="p">[:</span><span class="mi">2</span><span class="p">],</span><span class="n">p</span><span class="p">,</span><span class="n">n</span><span class="p">,</span><span class="n">mode</span><span class="o">=</span><span class="s">&#39;pair&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">x1</span><span class="p">)</span>
<span class="go">[[ 2.  0.  0.]</span>
<span class="go"> [ 0.  0.  1.]]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">x2</span><span class="p">)</span>
<span class="go">[[ 2.  0.  0.]</span>
<span class="go"> [ 0.  0.  1.]]</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">t1</span><span class="p">,</span><span class="n">t2</span> <span class="o">=</span> <span class="n">intersectLineWithLine</span><span class="p">(</span><span class="n">q</span><span class="p">,</span><span class="n">m</span><span class="p">,</span><span class="n">p</span><span class="p">,</span><span class="n">n</span><span class="p">,</span><span class="n">times</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">t1</span><span class="p">)</span>
<span class="go">[[  2.  -0.]</span>
<span class="go"> [  2.  -0.]</span>
<span class="go"> [ nan  -0.]]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">t2</span><span class="p">)</span>
<span class="go">[[ -0.  -0.]</span>
<span class="go"> [  2.   1.]</span>
<span class="go"> [ nan   3.]]</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">t1</span><span class="p">,</span><span class="n">t2</span> <span class="o">=</span> <span class="n">intersectLineWithLine</span><span class="p">(</span><span class="n">q</span><span class="p">[:</span><span class="mi">2</span><span class="p">],</span><span class="n">m</span><span class="p">[:</span><span class="mi">2</span><span class="p">],</span><span class="n">p</span><span class="p">,</span><span class="n">n</span><span class="p">,</span><span class="n">mode</span><span class="o">=</span><span class="s">&#39;pair&#39;</span><span class="p">,</span><span class="n">times</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">t1</span><span class="p">)</span>
<span class="go">[ 2. -0.]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">t2</span><span class="p">)</span>
<span class="go">[-0.  1.]</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="geomtools.intersectionTimesLWP">
<tt class="descclassname">geomtools.</tt><tt class="descname">intersectionTimesLWP</tt><big>(</big><em>q</em>, <em>m</em>, <em>p</em>, <em>n</em>, <em>mode='all'</em><big>)</big><a class="headerlink" href="#geomtools.intersectionTimesLWP" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the intersection of lines (q,m) with planes (p,n).</p>
<p>Parameters:</p>
<ul class="simple">
<li><cite>q</cite>,`m`: (nq,3) shaped arrays of points and vectors (<cite>mode=all</cite>)
or broadcast compatible arrays (<cite>mode=pair</cite>), defining a single line
or a set of lines.</li>
<li><cite>p</cite>,`n`: (np,3) shaped arrays of points and normals (<cite>mode=all</cite>)
or broadcast compatible arrays (<cite>mode=pair</cite>), defining a single plane
or a set of planes.</li>
<li><cite>mode</cite>: <cite>all</cite> to calculate the intersection of each line (q,m) with
all planes (p,n) or <cite>pair</cite> for pairwise intersections.</li>
</ul>
<p>Returns a (nq,np) shaped (<cite>mode=all</cite>) array of parameter values t,
such that the intersection points are given by q+t*m.</p>
<p>Notice that the result will contain an INF value for lines that are
parallel to the plane.</p>
</dd></dl>

<dl class="function">
<dt id="geomtools.intersectionPointsLWP">
<tt class="descclassname">geomtools.</tt><tt class="descname">intersectionPointsLWP</tt><big>(</big><em>q</em>, <em>m</em>, <em>p</em>, <em>n</em>, <em>mode='all'</em><big>)</big><a class="headerlink" href="#geomtools.intersectionPointsLWP" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the intersection points of lines (q,m) with planes (p,n).</p>
<p>This is like intersectionTimesLWP but returns a (nq,np,3) shaped
(<cite>mode=all</cite>) array of intersection points instead of the
parameter values.</p>
</dd></dl>

<dl class="function">
<dt id="geomtools.intersectionTimesSWP">
<tt class="descclassname">geomtools.</tt><tt class="descname">intersectionTimesSWP</tt><big>(</big><em>S</em>, <em>p</em>, <em>n</em>, <em>mode='all'</em><big>)</big><a class="headerlink" href="#geomtools.intersectionTimesSWP" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the intersection of line segments S with planes (p,n).</p>
<p>This is like intersectionTimesLWP, but the lines are defined by two points
instead of by a point and a vector.
Parameters:</p>
<ul class="simple">
<li><cite>S</cite>: (nS,2,3) shaped array (<cite>mode=all</cite>) or broadcast compatible array
(<cite>mode=pair</cite>), defining one or more line segments.</li>
<li><cite>p</cite>,`n`: (np,3) shaped arrays of points and normals (<cite>mode=all</cite>)
or broadcast compatible arrays (<cite>mode=pair</cite>), defining a single plane
or a set of planes.</li>
<li><cite>mode</cite>: <cite>all</cite> to calculate the intersection of each line segment S with
all planes (p,n) or <cite>pair</cite> for pairwise intersections.</li>
</ul>
<p>Returns a (nS,np) shaped (<cite>mode=all</cite>) array of parameter values t,
such that the intersection points are given by
<cite>(1-t)*S[...,0,:] + t*S[...,1,:]</cite>.</p>
</dd></dl>

<dl class="function">
<dt id="geomtools.intersectionSWP">
<tt class="descclassname">geomtools.</tt><tt class="descname">intersectionSWP</tt><big>(</big><em>S</em>, <em>p</em>, <em>n</em>, <em>mode='all'</em>, <em>return_all=False</em>, <em>atol=0.0</em><big>)</big><a class="headerlink" href="#geomtools.intersectionSWP" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the intersection points of line segments S with planes (p,n).</p>
<p>Parameters:</p>
<ul class="simple">
<li><cite>S</cite>: (nS,2,3) shaped array, defining a single line segment or a set of
line segments.</li>
<li><cite>p</cite>,`n`: (np,3) shaped arrays of points and normals, defining a single
plane or a set of planes.</li>
<li><cite>mode</cite>: <cite>all</cite> to calculate the intersection of each line segment S with
all planes (p,n) or <cite>pair</cite> for pairwise intersections.</li>
<li><cite>return_all</cite>: if True, all intersection points of the lines along the
segments are returned. Default is to return only the points that lie
on the segments.</li>
<li><cite>atol</cite>: float tolerance of the points inside the line segments.</li>
</ul>
<p>Return values if <cite>return_all==True</cite>:</p>
<ul class="simple">
<li><cite>t</cite>: (nS,NP) parametric values of the intersection points along the line
segments.</li>
<li><cite>x</cite>: the intersection points themselves (nS,nP,3).</li>
</ul>
<p>Return values if <cite>return_all==False</cite>:</p>
<ul class="simple">
<li><cite>t</cite>: (n,) parametric values of the intersection points along the line
segments (n &lt;= nS*nP)</li>
<li><cite>x</cite>: the intersection points themselves (n,3).</li>
<li><cite>wl</cite>: (n,) line indices corresponding with the returned intersections.</li>
<li><cite>wp</cite>: (n,) plane indices corresponding with the returned intersections</li>
</ul>
</dd></dl>

<dl class="function">
<dt id="geomtools.intersectionPointsSWP">
<tt class="descclassname">geomtools.</tt><tt class="descname">intersectionPointsSWP</tt><big>(</big><em>S</em>, <em>p</em>, <em>n</em>, <em>mode='all'</em>, <em>return_all=False</em>, <em>atol=0.0</em><big>)</big><a class="headerlink" href="#geomtools.intersectionPointsSWP" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the intersection points of line segments S with planes (p,n) within tolerance atol.</p>
<p>This is like <a class="reference internal" href="#geomtools.intersectionSWP" title="geomtools.intersectionSWP"><tt class="xref py py-func docutils literal"><span class="pre">intersectionSWP()</span></tt></a> but does not return the parameter
values. It is equivalent to:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">intersectionSWP</span><span class="p">(</span><span class="n">S</span><span class="p">,</span><span class="n">p</span><span class="p">,</span><span class="n">n</span><span class="p">,</span><span class="n">mode</span><span class="p">,</span><span class="n">return_all</span><span class="p">)[</span><span class="mi">1</span><span class="p">:]</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="geomtools.intersectionTimesLWT">
<tt class="descclassname">geomtools.</tt><tt class="descname">intersectionTimesLWT</tt><big>(</big><em>q</em>, <em>m</em>, <em>F</em>, <em>mode='all'</em><big>)</big><a class="headerlink" href="#geomtools.intersectionTimesLWT" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the intersection of lines (q,m) with triangles F.</p>
<p>Parameters:</p>
<ul class="simple">
<li><cite>q</cite>,`m`: (nq,3) shaped arrays of points and vectors (<cite>mode=all</cite>)
or broadcast compatible arrays (<cite>mode=pair</cite>), defining a single line
or a set of lines.</li>
<li><cite>F</cite>: (nF,3,3) shaped array (<cite>mode=all</cite>) or broadcast compatible array
(<cite>mode=pair</cite>), defining a single triangle or a set of triangles.</li>
<li><cite>mode</cite>: <cite>all</cite> to calculate the intersection of each line (q,m) with
all triangles F or <cite>pair</cite> for pairwise intersections.</li>
</ul>
<dl class="docutils">
<dt>Returns a (nq,nF) shaped (<cite>mode=all</cite>) array of parameter values t,</dt>
<dd>such that the intersection points are given q+tm.</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="geomtools.intersectionPointsLWT">
<tt class="descclassname">geomtools.</tt><tt class="descname">intersectionPointsLWT</tt><big>(</big><em>q</em>, <em>m</em>, <em>F</em>, <em>mode='all'</em>, <em>return_all=False</em><big>)</big><a class="headerlink" href="#geomtools.intersectionPointsLWT" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the intersection points of lines (q,m) with triangles F.</p>
<p>Parameters:</p>
<ul class="simple">
<li><cite>q</cite>,`m`: (nq,3) shaped arrays of points and vectors, defining a single
line or a set of lines.</li>
<li><cite>F</cite>: (nF,3,3) shaped array, defining a single triangle or a set of
triangles.</li>
<li><cite>mode</cite>: <cite>all</cite> to calculate the intersection points of each line (q,m) with
all triangles F or <cite>pair</cite> for pairwise intersections.</li>
<li><cite>return_all</cite>: if True, all intersection points are returned. Default is
to return only the points that lie inside the triangles.</li>
</ul>
<p>Returns:</p>
<blockquote>
<div>If <cite>return_all==True</cite>, a (nq,nF,3) shaped (<cite>mode=all</cite>) array of
intersection points, else, a tuple of intersection points with shape (n,3)
and line and plane indices with shape (n), where n &lt;= nq*nF.</div></blockquote>
</dd></dl>

<dl class="function">
<dt id="geomtools.intersectionTimesSWT">
<tt class="descclassname">geomtools.</tt><tt class="descname">intersectionTimesSWT</tt><big>(</big><em>S</em>, <em>F</em>, <em>mode='all'</em><big>)</big><a class="headerlink" href="#geomtools.intersectionTimesSWT" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the intersection of lines segments S with triangles F.</p>
<p>Parameters:</p>
<ul class="simple">
<li><cite>S</cite>: (nS,2,3) shaped array (<cite>mode=all</cite>) or broadcast compatible array
(<cite>mode=pair</cite>), defining a single line segment or a set of line segments.</li>
<li><cite>F</cite>: (nF,3,3) shaped array (<cite>mode=all</cite>) or broadcast compatible array
(<cite>mode=pair</cite>), defining a single triangle or a set of triangles.</li>
<li><cite>mode</cite>: <cite>all</cite> to calculate the intersection of each line segment S with
all triangles F or <cite>pair</cite> for pairwise intersections.</li>
</ul>
<p>Returns a (nS,nF) shaped (<cite>mode=all</cite>) array of parameter values t,
such that the intersection points are given by
<cite>(1-t)*S[...,0,:] + t*S[...,1,:]</cite>.</p>
</dd></dl>

<dl class="function">
<dt id="geomtools.intersectionPointsSWT">
<tt class="descclassname">geomtools.</tt><tt class="descname">intersectionPointsSWT</tt><big>(</big><em>S</em>, <em>F</em>, <em>mode='all'</em>, <em>return_all=False</em><big>)</big><a class="headerlink" href="#geomtools.intersectionPointsSWT" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the intersection points of lines segments S with triangles F.</p>
<p>Parameters:</p>
<ul class="simple">
<li><cite>S</cite>: (nS,2,3) shaped array, defining a single line segment or a set of
line segments.</li>
<li><cite>F</cite>: (nF,3,3) shaped array, defining a single triangle or a set of
triangles.</li>
<li><cite>mode</cite>: <cite>all</cite> to calculate the intersection points of each line segment S
with all triangles F or <cite>pair</cite> for pairwise intersections.</li>
<li><cite>return_all</cite>: if True, all intersection points are returned. Default is
to return only the points that lie on the segments and inside the
triangles.</li>
</ul>
<p>Returns:</p>
<blockquote>
<div>If <cite>return_all==True</cite>, a (nS,nF,3) shaped (<cite>mode=all</cite>) array of
intersection points, else, a tuple of intersection points with shape (n,3)
and line and plane indices with shape (n), where n &lt;= nS*nF.</div></blockquote>
</dd></dl>

<dl class="function">
<dt id="geomtools.intersectionPointsPWP">
<tt class="descclassname">geomtools.</tt><tt class="descname">intersectionPointsPWP</tt><big>(</big><em>p1</em>, <em>n1</em>, <em>p2</em>, <em>n2</em>, <em>p3</em>, <em>n3</em>, <em>mode='all'</em><big>)</big><a class="headerlink" href="#geomtools.intersectionPointsPWP" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the intersection points of planes (p1,n1), (p2,n2) and (p3,n3).</p>
<p>Parameters:</p>
<ul class="simple">
<li><cite>pi</cite>,`ni` (i=1...3): (npi,3) shaped arrays of points and normals
(<cite>mode=all</cite>)
or broadcast compatible arrays (<cite>mode=pair</cite>), defining a single plane
or a set of planes.</li>
<li><cite>mode</cite>: <cite>all</cite> to calculate the intersection of each plane (p1,n1) with
all planes (p2,n2) and (p3,n3) or <cite>pair</cite> for pairwise intersections.</li>
</ul>
<p>Returns a (np1,np2,np3,3) shaped (<cite>mode=all</cite>) array of intersection points.</p>
</dd></dl>

<dl class="function">
<dt id="geomtools.intersectionLinesPWP">
<tt class="descclassname">geomtools.</tt><tt class="descname">intersectionLinesPWP</tt><big>(</big><em>p1</em>, <em>n1</em>, <em>p2</em>, <em>n2</em>, <em>mode='all'</em><big>)</big><a class="headerlink" href="#geomtools.intersectionLinesPWP" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the intersection lines of planes (p1,n1) and (p2,n2).</p>
<p>Parameters:</p>
<ul class="simple">
<li><cite>pi</cite>,`ni` (i=1...2): (npi,3) shaped arrays of points and normals (<cite>mode=all</cite>)
or broadcast compatible arrays (<cite>mode=pair</cite>), defining a single plane
or a set of planes.</li>
<li><cite>mode</cite>: <cite>all</cite> to calculate the intersection of each plane (p1,n1) with
all planes (p2,n2) or <cite>pair</cite> for pairwise intersections.</li>
</ul>
<p>Returns a tuple of (np1,np2,3) shaped (<cite>mode=all</cite>) arrays of intersection
points q and vectors m, such that the intersection lines are given by
<tt class="docutils literal"><span class="pre">q+t*m</span></tt>.</p>
</dd></dl>

<dl class="function">
<dt id="geomtools.intersectionSphereSphere">
<tt class="descclassname">geomtools.</tt><tt class="descname">intersectionSphereSphere</tt><big>(</big><em>R</em>, <em>r</em>, <em>d</em><big>)</big><a class="headerlink" href="#geomtools.intersectionSphereSphere" title="Permalink to this definition">¶</a></dt>
<dd><p>Intersection of two spheres (or two circles in the x,y plane).</p>
<p>Computes the intersection of two spheres with radii R, resp. r, having
their centres at distance d &lt;= R+r. The intersection is a circle with
its center on the segment connecting the two sphere centers at a distance
x from the first sphere, and having a radius y. The return value is a
tuple x,y.</p>
</dd></dl>

<dl class="function">
<dt id="geomtools.projectPointOnPlane">
<tt class="descclassname">geomtools.</tt><tt class="descname">projectPointOnPlane</tt><big>(</big><em>X</em>, <em>p</em>, <em>n</em>, <em>mode='all'</em><big>)</big><a class="headerlink" href="#geomtools.projectPointOnPlane" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the projection of points X on planes (p,n).</p>
<p>Parameters:</p>
<ul class="simple">
<li><cite>X</cite>: a (nx,3) shaped array of points.</li>
<li><cite>p</cite>, <cite>n</cite>: (np,3) shaped arrays of points and normals defining <cite>np</cite> planes.</li>
<li><cite>mode</cite>: &#8216;all&#8217; or &#8216;pair:<ul>
<li>if &#8216;all&#8217;, the projection of all points on all planes is computed;
<cite>nx</cite> and <cite>np</cite> can be different.</li>
<li>if &#8216;pair&#8217;: <cite>nx</cite> and <cite>np</cite> should be equal (or 1) and the projection
of pairs of point and plane are computed (using broadcasting for
length 1 data).</li>
</ul>
</li>
</ul>
<p>Returns a float array of size (nx,np,3) for mode &#8216;all&#8217;, or size (nx,3)
for mode &#8216;pair&#8217;.</p>
<p>Example:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">X</span> <span class="o">=</span> <span class="n">Coords</span><span class="p">([[</span><span class="mf">0.</span><span class="p">,</span><span class="mf">1.</span><span class="p">,</span><span class="mf">0.</span><span class="p">],[</span><span class="mf">3.</span><span class="p">,</span><span class="mf">0.</span><span class="p">,</span><span class="mf">0.</span><span class="p">],[</span><span class="mf">4.</span><span class="p">,</span><span class="mf">3.</span><span class="p">,</span><span class="mf">0.</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">p</span><span class="p">,</span><span class="n">n</span> <span class="o">=</span> <span class="p">[[</span><span class="mf">2.</span><span class="p">,</span><span class="mf">0.</span><span class="p">,</span><span class="mf">0.</span><span class="p">],[</span><span class="mf">0.</span><span class="p">,</span><span class="mf">1.</span><span class="p">,</span><span class="mf">0.</span><span class="p">]],</span> <span class="p">[[</span><span class="mf">1.</span><span class="p">,</span><span class="mf">0.</span><span class="p">,</span><span class="mf">0.</span><span class="p">],[</span><span class="mf">0.</span><span class="p">,</span><span class="mf">1.</span><span class="p">,</span><span class="mf">0.</span><span class="p">]]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">projectPointOnPlane</span><span class="p">(</span><span class="n">X</span><span class="p">,</span><span class="n">p</span><span class="p">,</span><span class="n">n</span><span class="p">))</span>
<span class="go">[[[ 2.  1.  0.]</span>
<span class="go">  [ 0.  1.  0.]]</span>

<span class="go"> [[ 2.  0.  0.]</span>
<span class="go">  [ 3.  1.  0.]]</span>

<span class="go"> [[ 2.  3.  0.]</span>
<span class="go">  [ 4.  1.  0.]]]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">projectPointOnPlane</span><span class="p">(</span><span class="n">X</span><span class="p">[:</span><span class="mi">2</span><span class="p">],</span><span class="n">p</span><span class="p">,</span><span class="n">n</span><span class="p">,</span><span class="n">mode</span><span class="o">=</span><span class="s">&#39;pair&#39;</span><span class="p">))</span>
<span class="go">[[ 2.  1.  0.]</span>
<span class="go"> [ 3.  1.  0.]]</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="geomtools.projectPointOnPlaneTimes">
<tt class="descclassname">geomtools.</tt><tt class="descname">projectPointOnPlaneTimes</tt><big>(</big><em>X</em>, <em>p</em>, <em>n</em>, <em>mode='all'</em><big>)</big><a class="headerlink" href="#geomtools.projectPointOnPlaneTimes" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the projection of points X on planes (p,n).</p>
<p>This is like <a class="reference internal" href="#geomtools.projectPointOnPlane" title="geomtools.projectPointOnPlane"><tt class="xref py py-meth docutils literal"><span class="pre">projectPointOnPlane()</span></tt></a> but instead of returning
the projected points, returns the parametric values t along the
lines (X,n), such that the projection points can be computed from
X+t*n.</p>
<p>Parameters: see <a class="reference internal" href="#geomtools.projectPointOnPlane" title="geomtools.projectPointOnPlane"><tt class="xref py py-meth docutils literal"><span class="pre">projectPointOnPlane()</span></tt></a>.</p>
<p>Returns a float array of size (nx,np) for mode &#8216;all&#8217;, or size (nx,)
for mode &#8216;pair&#8217;.</p>
<p>Example:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">X</span> <span class="o">=</span> <span class="n">Coords</span><span class="p">([[</span><span class="mf">0.</span><span class="p">,</span><span class="mf">1.</span><span class="p">,</span><span class="mf">0.</span><span class="p">],[</span><span class="mf">3.</span><span class="p">,</span><span class="mf">0.</span><span class="p">,</span><span class="mf">0.</span><span class="p">],[</span><span class="mf">4.</span><span class="p">,</span><span class="mf">3.</span><span class="p">,</span><span class="mf">0.</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">p</span><span class="p">,</span><span class="n">n</span> <span class="o">=</span> <span class="p">[[</span><span class="mf">2.</span><span class="p">,</span><span class="mf">0.</span><span class="p">,</span><span class="mf">0.</span><span class="p">],[</span><span class="mf">0.</span><span class="p">,</span><span class="mf">1.</span><span class="p">,</span><span class="mf">0.</span><span class="p">]],</span> <span class="p">[[</span><span class="mf">1.</span><span class="p">,</span><span class="mf">0.</span><span class="p">,</span><span class="mf">0.</span><span class="p">],[</span><span class="mf">0.</span><span class="p">,</span><span class="mf">1.</span><span class="p">,</span><span class="mf">0.</span><span class="p">]]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">projectPointOnPlaneTimes</span><span class="p">(</span><span class="n">X</span><span class="p">,</span><span class="n">p</span><span class="p">,</span><span class="n">n</span><span class="p">))</span>
<span class="go">[[ 2.  0.]</span>
<span class="go"> [-1.  1.]</span>
<span class="go"> [-2. -2.]]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">projectPointOnPlaneTimes</span><span class="p">(</span><span class="n">X</span><span class="p">[:</span><span class="mi">2</span><span class="p">],</span><span class="n">p</span><span class="p">,</span><span class="n">n</span><span class="p">,</span><span class="n">mode</span><span class="o">=</span><span class="s">&#39;pair&#39;</span><span class="p">))</span>
<span class="go">[ 2.  1.]</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="geomtools.projectPointOnLine">
<tt class="descclassname">geomtools.</tt><tt class="descname">projectPointOnLine</tt><big>(</big><em>X</em>, <em>p</em>, <em>n</em>, <em>mode='all'</em><big>)</big><a class="headerlink" href="#geomtools.projectPointOnLine" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the projection of points X on lines (p,n).</p>
<p>Parameters:</p>
<ul class="simple">
<li><cite>X</cite>: a (nx,3) shaped array of points.</li>
<li><cite>p</cite>, <cite>n</cite>: (np,3) shaped arrays of points and vectors defining <cite>np</cite> lines.</li>
<li><cite>mode</cite>: &#8216;all&#8217; or &#8216;pair:<ul>
<li>if &#8216;all&#8217;, the projection of all points on all lines is computed;
<cite>nx</cite> and <cite>np</cite> can be different.</li>
<li>if &#8216;pair&#8217;: <cite>nx</cite> and <cite>np</cite> should be equal (or 1) and the projection
of pairs of point and line are computed (using broadcasting for
length 1 data).</li>
</ul>
</li>
</ul>
<p>Returns a float array of size (nx,np,3) for mode &#8216;all&#8217;, or size (nx,3)
for mode &#8216;pair&#8217;.</p>
<p>Example:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">X</span> <span class="o">=</span> <span class="n">Coords</span><span class="p">([[</span><span class="mf">0.</span><span class="p">,</span><span class="mf">1.</span><span class="p">,</span><span class="mf">0.</span><span class="p">],[</span><span class="mf">3.</span><span class="p">,</span><span class="mf">0.</span><span class="p">,</span><span class="mf">0.</span><span class="p">],[</span><span class="mf">4.</span><span class="p">,</span><span class="mf">3.</span><span class="p">,</span><span class="mf">0.</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">p</span><span class="p">,</span><span class="n">n</span> <span class="o">=</span> <span class="p">[[</span><span class="mf">2.</span><span class="p">,</span><span class="mf">0.</span><span class="p">,</span><span class="mf">0.</span><span class="p">],[</span><span class="mf">0.</span><span class="p">,</span><span class="mf">1.</span><span class="p">,</span><span class="mf">0.</span><span class="p">]],</span> <span class="p">[[</span><span class="mf">0.</span><span class="p">,</span><span class="mf">2.</span><span class="p">,</span><span class="mf">0.</span><span class="p">],[</span><span class="mf">1.</span><span class="p">,</span><span class="mf">0.</span><span class="p">,</span><span class="mf">0.</span><span class="p">]]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">projectPointOnLine</span><span class="p">(</span><span class="n">X</span><span class="p">,</span><span class="n">p</span><span class="p">,</span><span class="n">n</span><span class="p">))</span>
<span class="go">[[[ 2.  1.  0.]</span>
<span class="go">  [ 0.  1.  0.]]</span>

<span class="go"> [[ 2.  0.  0.]</span>
<span class="go">  [ 3.  1.  0.]]</span>

<span class="go"> [[ 2.  3.  0.]</span>
<span class="go">  [ 4.  1.  0.]]]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">projectPointOnLine</span><span class="p">(</span><span class="n">X</span><span class="p">[:</span><span class="mi">2</span><span class="p">],</span><span class="n">p</span><span class="p">,</span><span class="n">n</span><span class="p">,</span><span class="n">mode</span><span class="o">=</span><span class="s">&#39;pair&#39;</span><span class="p">))</span>
<span class="go">[[ 2.  1.  0.]</span>
<span class="go"> [ 3.  1.  0.]]</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="geomtools.projectPointOnLineTimes">
<tt class="descclassname">geomtools.</tt><tt class="descname">projectPointOnLineTimes</tt><big>(</big><em>X</em>, <em>p</em>, <em>n</em>, <em>mode='all'</em><big>)</big><a class="headerlink" href="#geomtools.projectPointOnLineTimes" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the projection of points X on lines (p,n).</p>
<p>This is like <a class="reference internal" href="#geomtools.projectPointOnLine" title="geomtools.projectPointOnLine"><tt class="xref py py-meth docutils literal"><span class="pre">projectPointOnLine()</span></tt></a> but instead of returning
the projected points, returns the parametric values t along the
lines (X,n), such that the projection points can be computed from
p+t*n.</p>
<p>Parameters: see <a class="reference internal" href="#geomtools.projectPointOnLine" title="geomtools.projectPointOnLine"><tt class="xref py py-meth docutils literal"><span class="pre">projectPointOnLine()</span></tt></a>.</p>
<p>Returns a float array of size (nx,np) for mode &#8216;all&#8217;, or size (nx,)
for mode &#8216;pair&#8217;.</p>
<p>Example:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">X</span> <span class="o">=</span> <span class="n">Coords</span><span class="p">([[</span><span class="mf">0.</span><span class="p">,</span><span class="mf">1.</span><span class="p">,</span><span class="mf">0.</span><span class="p">],[</span><span class="mf">3.</span><span class="p">,</span><span class="mf">0.</span><span class="p">,</span><span class="mf">0.</span><span class="p">],[</span><span class="mf">4.</span><span class="p">,</span><span class="mf">3.</span><span class="p">,</span><span class="mf">0.</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">p</span><span class="p">,</span><span class="n">n</span> <span class="o">=</span> <span class="p">[[</span><span class="mf">2.</span><span class="p">,</span><span class="mf">0.</span><span class="p">,</span><span class="mf">0.</span><span class="p">],[</span><span class="mf">0.</span><span class="p">,</span><span class="mf">1.</span><span class="p">,</span><span class="mf">0.</span><span class="p">]],</span> <span class="p">[[</span><span class="mf">0.</span><span class="p">,</span><span class="mf">1.</span><span class="p">,</span><span class="mf">0.</span><span class="p">],[</span><span class="mf">1.</span><span class="p">,</span><span class="mf">0.</span><span class="p">,</span><span class="mf">0.</span><span class="p">]]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">projectPointOnLineTimes</span><span class="p">(</span><span class="n">X</span><span class="p">,</span><span class="n">p</span><span class="p">,</span><span class="n">n</span><span class="p">))</span>
<span class="go">[[ 1.  0.]</span>
<span class="go"> [ 0.  3.]</span>
<span class="go"> [ 3.  4.]]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">projectPointOnLineTimes</span><span class="p">(</span><span class="n">X</span><span class="p">[:</span><span class="mi">2</span><span class="p">],</span><span class="n">p</span><span class="p">,</span><span class="n">n</span><span class="p">,</span><span class="n">mode</span><span class="o">=</span><span class="s">&#39;pair&#39;</span><span class="p">))</span>
<span class="go">[ 1.  3.]</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="geomtools.distanceFromLine">
<tt class="descclassname">geomtools.</tt><tt class="descname">distanceFromLine</tt><big>(</big><em>X</em>, <em>lines</em>, <em>mode='all'</em><big>)</big><a class="headerlink" href="#geomtools.distanceFromLine" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the distance of points X from lines (p,n).</p>
<p>Parameters:</p>
<ul class="simple">
<li><cite>X</cite>: a (nx,3) shaped array of points.</li>
<li><cite>lines</cite>: one of the following definitions of the line(s):<ul>
<li>a tuple (p,n), where both p and n are (np,3) shaped arrays of
respectively points and vectors defining <cite>np</cite> lines;</li>
<li>an (np,2,3) shaped array containing two points of each line.</li>
</ul>
</li>
<li><cite>mode</cite>: &#8216;all&#8217; or &#8216;pair:<ul>
<li>if &#8216;all&#8217;, the distance of all points to all lines is computed;
<cite>nx</cite> and <cite>np</cite> can be different.</li>
<li>if &#8216;pair&#8217;: <cite>nx</cite> and <cite>np</cite> should be equal (or 1) and the distance
of pairs of point and line are computed (using broadcasting for
length 1 data).</li>
</ul>
</li>
</ul>
<p>Returns a float array of size (nx,np) for mode &#8216;all&#8217;, or size (nx)
for mode &#8216;pair&#8217;.</p>
<p>Example:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">X</span> <span class="o">=</span> <span class="n">Coords</span><span class="p">([[</span><span class="mf">0.</span><span class="p">,</span><span class="mf">1.</span><span class="p">,</span><span class="mf">0.</span><span class="p">],[</span><span class="mf">3.</span><span class="p">,</span><span class="mf">0.</span><span class="p">,</span><span class="mf">0.</span><span class="p">],[</span><span class="mf">4.</span><span class="p">,</span><span class="mf">3.</span><span class="p">,</span><span class="mf">0.</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">L</span> <span class="o">=</span> <span class="n">Line</span><span class="p">([[</span><span class="mf">2.</span><span class="p">,</span><span class="mf">0.</span><span class="p">,</span><span class="mf">0.</span><span class="p">],[</span><span class="mf">0.</span><span class="p">,</span><span class="mf">1.</span><span class="p">,</span><span class="mf">0.</span><span class="p">]],</span> <span class="p">[[</span><span class="mf">0.</span><span class="p">,</span><span class="mf">3.</span><span class="p">,</span><span class="mf">0.</span><span class="p">],[</span><span class="mf">1.</span><span class="p">,</span><span class="mf">0.</span><span class="p">,</span><span class="mf">0.</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">distanceFromLine</span><span class="p">(</span><span class="n">X</span><span class="p">,</span><span class="n">L</span><span class="p">))</span>
<span class="go">[[ 2.  0.]</span>
<span class="go"> [ 1.  1.]</span>
<span class="go"> [ 2.  2.]]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">distanceFromLine</span><span class="p">(</span><span class="n">X</span><span class="p">[:</span><span class="mi">2</span><span class="p">],</span><span class="n">L</span><span class="p">,</span><span class="n">mode</span><span class="o">=</span><span class="s">&#39;pair&#39;</span><span class="p">))</span>
<span class="go">[ 2.  1.]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">L</span> <span class="o">=</span> <span class="n">Line</span><span class="p">([[[</span><span class="mf">2.</span><span class="p">,</span><span class="mf">0.</span><span class="p">,</span><span class="mf">0.</span><span class="p">],[</span><span class="mf">2.</span><span class="p">,</span><span class="mf">2.</span><span class="p">,</span><span class="mf">0.</span><span class="p">]],</span> <span class="p">[[</span><span class="mf">0.</span><span class="p">,</span><span class="mf">1.</span><span class="p">,</span><span class="mf">0.</span><span class="p">],[</span><span class="mf">1.</span><span class="p">,</span><span class="mf">1.</span><span class="p">,</span><span class="mf">0.</span><span class="p">]]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">distanceFromLine</span><span class="p">(</span><span class="n">X</span><span class="p">,</span><span class="n">L</span><span class="p">))</span>
<span class="go">[[ 2.  0.]</span>
<span class="go"> [ 1.  1.]</span>
<span class="go"> [ 2.  2.]]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">distanceFromLine</span><span class="p">(</span><span class="n">X</span><span class="p">[:</span><span class="mi">2</span><span class="p">],</span><span class="n">L</span><span class="p">,</span><span class="n">mode</span><span class="o">=</span><span class="s">&#39;pair&#39;</span><span class="p">))</span>
<span class="go">[ 2.  1.]</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="geomtools.pointNearLine">
<tt class="descclassname">geomtools.</tt><tt class="descname">pointNearLine</tt><big>(</big><em>X</em>, <em>p</em>, <em>n</em>, <em>atol</em>, <em>nproc=1</em><big>)</big><a class="headerlink" href="#geomtools.pointNearLine" title="Permalink to this definition">¶</a></dt>
<dd><p>Find the points from X that are near to lines (p,n).</p>
<p>Finds the points from X that are closer than atol to any of the lines (p,n).</p>
<p>Parameters:</p>
<ul class="simple">
<li><cite>X</cite>: a (nx,3) shaped array of points.</li>
<li><cite>p</cite>, <cite>n</cite>: (np,3) shaped arrays of points and vectors defining <cite>np</cite> lines.</li>
<li><cite>atol</cite>: float or (nx,) shaped float array of pointwise tolerances</li>
</ul>
<p>Returns a list of arrays with sorted point indices for each of the lines.</p>
<p>Example:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">X</span> <span class="o">=</span> <span class="n">Coords</span><span class="p">([[</span><span class="mf">0.</span><span class="p">,</span><span class="mf">1.</span><span class="p">,</span><span class="mf">0.</span><span class="p">],[</span><span class="mf">3.</span><span class="p">,</span><span class="mf">0.</span><span class="p">,</span><span class="mf">0.</span><span class="p">],[</span><span class="mf">4.</span><span class="p">,</span><span class="mf">3.</span><span class="p">,</span><span class="mf">0.</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">p</span><span class="p">,</span><span class="n">n</span> <span class="o">=</span> <span class="p">[[</span><span class="mf">2.</span><span class="p">,</span><span class="mf">0.</span><span class="p">,</span><span class="mf">0.</span><span class="p">],[</span><span class="mf">0.</span><span class="p">,</span><span class="mf">1.</span><span class="p">,</span><span class="mf">0.</span><span class="p">]],</span> <span class="p">[[</span><span class="mf">0.</span><span class="p">,</span><span class="mf">3.</span><span class="p">,</span><span class="mf">0.</span><span class="p">],[</span><span class="mf">1.</span><span class="p">,</span><span class="mf">0.</span><span class="p">,</span><span class="mf">0.</span><span class="p">]]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">pointNearLine</span><span class="p">(</span><span class="n">X</span><span class="p">,</span><span class="n">p</span><span class="p">,</span><span class="n">n</span><span class="p">,</span><span class="mf">1.5</span><span class="p">))</span>
<span class="go">[array([1]), array([0, 1])]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">pointNearLine</span><span class="p">(</span><span class="n">X</span><span class="p">,</span><span class="n">p</span><span class="p">,</span><span class="n">n</span><span class="p">,</span><span class="mf">1.5</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span>
<span class="go">[array([1]), array([0, 1])]</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="geomtools.faceDistance">
<tt class="descclassname">geomtools.</tt><tt class="descname">faceDistance</tt><big>(</big><em>X</em>, <em>Fp</em>, <em>return_points=False</em><big>)</big><a class="headerlink" href="#geomtools.faceDistance" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the closest perpendicular distance to a set of triangles.</p>
<p>X is a (nX,3) shaped array of points.
Fp is a (nF,3,3) shaped array of triangles.</p>
<p>Note that some points may not have a normal with footpoint inside any
of the facets.</p>
<p>The return value is a tuple OKpid,OKdist,OKpoints where:</p>
<ul class="simple">
<li>OKpid is an array with the point numbers having a normal distance;</li>
<li>OKdist is an array with the shortest distances for these points;</li>
<li>OKpoints is an array with the closest footpoints for these points
and is only returned if return_points = True.</li>
</ul>
</dd></dl>

<dl class="function">
<dt id="geomtools.edgeDistance">
<tt class="descclassname">geomtools.</tt><tt class="descname">edgeDistance</tt><big>(</big><em>X</em>, <em>Ep</em>, <em>return_points=False</em><big>)</big><a class="headerlink" href="#geomtools.edgeDistance" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the closest perpendicular distance of points X to a set of edges.</p>
<p>X is a (nX,3) shaped array of points.
Ep is a (nE,2,3) shaped array of edge vertices.</p>
<p>Note that some points may not have a normal with footpoint inside any
of the edges.</p>
<p>The return value is a tuple OKpid,OKdist,OKpoints where:</p>
<ul class="simple">
<li>OKpid is an array with the point numbers having a normal distance;</li>
<li>OKdist is an array with the shortest distances for these points;</li>
<li>OKpoints is an array with the closest footpoints for these points
and is only returned if return_points = True.</li>
</ul>
</dd></dl>

<dl class="function">
<dt id="geomtools.vertexDistance">
<tt class="descclassname">geomtools.</tt><tt class="descname">vertexDistance</tt><big>(</big><em>X</em>, <em>Vp</em>, <em>return_points=False</em><big>)</big><a class="headerlink" href="#geomtools.vertexDistance" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the closest distance of points X to a set of vertices.</p>
<p>X is a (nX,3) shaped array of points.
Vp is a (nV,3) shaped array of vertices.</p>
<p>The return value is a tuple OKdist,OKpoints where:</p>
<ul class="simple">
<li>OKdist is an array with the shortest distances for the points;</li>
<li>OKpoints is an array with the closest vertices for the points
and is only returned if return_points = True.</li>
</ul>
</dd></dl>

<dl class="function">
<dt id="geomtools.areaNormals">
<tt class="descclassname">geomtools.</tt><tt class="descname">areaNormals</tt><big>(</big><em>x</em><big>)</big><a class="headerlink" href="#geomtools.areaNormals" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the area and normal vectors of a collection of triangles.</p>
<p>x is an (ntri,3,3) array with the coordinates of the vertices of ntri
triangles.</p>
<p>Returns a tuple (areas,normals) with the areas and the normals of the
triangles. The area is always positive. The normal vectors are normalized.</p>
</dd></dl>

<dl class="function">
<dt id="geomtools.degenerate">
<tt class="descclassname">geomtools.</tt><tt class="descname">degenerate</tt><big>(</big><em>area</em>, <em>normals</em><big>)</big><a class="headerlink" href="#geomtools.degenerate" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a list of the degenerate faces according to area and normals.</p>
<p>area,normals are equal sized arrays with the areas and normals of a
list of faces, such as the output of the <a class="reference internal" href="#geomtools.areaNormals" title="geomtools.areaNormals"><tt class="xref py py-func docutils literal"><span class="pre">areaNormals()</span></tt></a> function.</p>
<p>A face is degenerate if its area is less or equal to zero or the
normal has a nan (not-a-number) value.</p>
<p>Returns a list of the degenerate element numbers as a sorted array.</p>
</dd></dl>

<dl class="function">
<dt id="geomtools.hexVolume">
<tt class="descclassname">geomtools.</tt><tt class="descname">hexVolume</tt><big>(</big><em>x</em><big>)</big><a class="headerlink" href="#geomtools.hexVolume" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the volume of hexahedrons.</p>
<p>Parameters:</p>
<ul class="simple">
<li><cite>x</cite>: float array (nelems,8,3)</li>
</ul>
<p>Returns a float array (nelems) withe the approximate volume of the
hexahedrons formed by each 8-tuple of vertices. The volume is obained
by dividing the hexahedron in 24 tetrahedrons and using the formulas
from <a class="reference external" href="http://www.osti.gov/scitech/servlets/purl/632793">http://www.osti.gov/scitech/servlets/purl/632793</a></p>
<p>Example:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">elements</span> <span class="kn">import</span> <span class="n">Hex8</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">X</span> <span class="o">=</span> <span class="n">Coords</span><span class="p">(</span><span class="n">Hex8</span><span class="o">.</span><span class="n">vertices</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">8</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">hexVolume</span><span class="p">(</span><span class="n">X</span><span class="p">))</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="geomtools.levelVolumes">
<tt class="descclassname">geomtools.</tt><tt class="descname">levelVolumes</tt><big>(</big><em>x</em><big>)</big><a class="headerlink" href="#geomtools.levelVolumes" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the level volumes of a collection of elements.</p>
<p>x is an (nelems,nplex,3) array with the coordinates of the nplex vertices
of nelems elements, with nplex equal to 2, 3 or 4.</p>
<p>If nplex == 2, returns the lengths of the straight line segments.
If nplex == 3, returns the areas of the triangle elements.
If nplex == 4, returns the signed volumes of the tetraeder elements.
Positive values result if vertex 3 is at the positive side of the plane
defined by the vertices (0,1,2). Negative volumes are reported for
tetraeders having reversed vertex order.</p>
<p>For any other value of nplex, raises an error.
If succesful, returns an (nelems,) shaped float array.</p>
</dd></dl>

<dl class="function">
<dt id="geomtools.inertialDirections">
<tt class="descclassname">geomtools.</tt><tt class="descname">inertialDirections</tt><big>(</big><em>x</em><big>)</big><a class="headerlink" href="#geomtools.inertialDirections" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the directions of the dimension of a Coords based of inertia.</p>
<ul class="simple">
<li><cite>x</cite>: a Coords-like array</li>
</ul>
<p>Returns a tuple of the direction vectors and the sizes  along the direction
and the cross directions. The arrays are ordered from the smallest to the largest direction.</p>
</dd></dl>

<dl class="function">
<dt id="geomtools.smallestDirection">
<tt class="descclassname">geomtools.</tt><tt class="descname">smallestDirection</tt><big>(</big><em>x</em>, <em>method='inertia'</em>, <em>return_size=False</em><big>)</big><a class="headerlink" href="#geomtools.smallestDirection" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the direction of the smallest dimension of a Coords</p>
<ul class="simple">
<li><cite>x</cite>: a Coords-like array</li>
<li><cite>method</cite>: one of &#8216;inertia&#8217; or &#8216;random&#8217;</li>
<li>return_size: if True and <cite>method</cite> is &#8216;inertia&#8217;, a tuple of a direction
vector and the size  along that direction and the cross directions;
else, only return the direction vector.</li>
</ul>
</dd></dl>

<dl class="function">
<dt id="geomtools.largestDirection">
<tt class="descclassname">geomtools.</tt><tt class="descname">largestDirection</tt><big>(</big><em>x</em>, <em>return_size=False</em><big>)</big><a class="headerlink" href="#geomtools.largestDirection" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the direction of the largest dimension of a Coords.</p>
<ul class="simple">
<li><cite>x</cite>: a Coords-like array</li>
<li>return_size: if True and <cite>method</cite> is &#8216;inertia&#8217;, a tuple of a direction
vector and the size  along that direction and the cross directions;
else, only return the direction vector.</li>
</ul>
</dd></dl>

<dl class="function">
<dt id="geomtools.distance">
<tt class="descclassname">geomtools.</tt><tt class="descname">distance</tt><big>(</big><em>X</em>, <em>Y</em><big>)</big><a class="headerlink" href="#geomtools.distance" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the distance of all points of X to those of Y.</p>
<p>Parameters:</p>
<ul class="simple">
<li><cite>X</cite>: (nX,3) shaped array of points.</li>
<li><cite>Y</cite>: (nY,3) shaped array of points.</li>
</ul>
<p>Returns an (nX,nT) shaped array with the distances between all points of
X and Y.</p>
</dd></dl>

<dl class="function">
<dt id="geomtools.closest">
<tt class="descclassname">geomtools.</tt><tt class="descname">closest</tt><big>(</big><em>X</em>, <em>Y=None</em>, <em>return_dist=False</em><big>)</big><a class="headerlink" href="#geomtools.closest" title="Permalink to this definition">¶</a></dt>
<dd><p>Find the point of Y closest to each of the points of X.</p>
<p>Parameters:</p>
<ul class="simple">
<li><cite>X</cite>: (nX,3) shaped array of points</li>
<li><cite>Y</cite>: (nY,3) shaped array of points. If None, Y is taken equal to X,
allowing to search for the closest point in a single set. In the latter
case, the point itself is excluded from the search (as otherwise
that would obviously be the closest one).</li>
<li><cite>return_dist</cite>: bool. If True, also returns the distances of the closest
points.</li>
</ul>
<p>Returns:</p>
<ul class="simple">
<li><cite>ind</cite>: (nX,) int array with the index of the closest point in Y to the
points of X</li>
<li><cite>dist</cite>: (nX,) float array with the distance of the closest point. This
is equal to length(X-Y[ind]). It is only returned if return_dist is True.</li>
</ul>
</dd></dl>

<dl class="function">
<dt id="geomtools.closestPair">
<tt class="descclassname">geomtools.</tt><tt class="descname">closestPair</tt><big>(</big><em>X</em>, <em>Y</em><big>)</big><a class="headerlink" href="#geomtools.closestPair" title="Permalink to this definition">¶</a></dt>
<dd><p>Find the closest pair of points from X and Y.</p>
<p>Parameters:</p>
<ul class="simple">
<li><cite>X</cite>: (nX,3) shaped array of points</li>
<li><cite>Y</cite>: (nY,3) shaped array of points</li>
</ul>
<p>Returns a tuple (i,j,d) where i,j are the indices in X,Y identifying
the closest points, and d is the distance between them.</p>
</dd></dl>

<dl class="function">
<dt id="geomtools.projectedArea">
<tt class="descclassname">geomtools.</tt><tt class="descname">projectedArea</tt><big>(</big><em>x</em>, <em>dir</em><big>)</big><a class="headerlink" href="#geomtools.projectedArea" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute projected area inside a polygon.</p>
<p>Parameters:</p>
<ul class="simple">
<li><cite>x</cite>: (npoints,3) Coords with the ordered vertices of a
(possibly nonplanar) polygonal contour.</li>
<li><cite>dir</cite>: either a global axis number (0, 1 or 2) or a direction vector
consisting of 3 floats, specifying the projection direction.</li>
</ul>
<p>Returns a single float value with the area inside the polygon projected
in the specified direction.</p>
<p>Note that if the polygon is planar and the specified direction is that
of the normal on its plane, the returned area is that of the planar
figure inside the polygon. If the polygon is nonplanar however, the area
inside the polygon is not defined. The projected area in a specified
direction is, since the projected polygon is a planar one.</p>
</dd></dl>

<dl class="function">
<dt id="geomtools.polygonNormals">
<tt class="descclassname">geomtools.</tt><tt class="descname">polygonNormals</tt><big>(</big><em>x</em><big>)</big><a class="headerlink" href="#geomtools.polygonNormals" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute normals in all points of polygons in x.</p>
<p>x is an (nel,nplex,3) coordinate array representing nel (possibly nonplanar)
polygons.</p>
<p>The return value is an (nel,nplex,3) array with the unit normals on the
two edges ending in each point.</p>
</dd></dl>

<dl class="function">
<dt id="geomtools.averageNormals">
<tt class="descclassname">geomtools.</tt><tt class="descname">averageNormals</tt><big>(</big><em>coords</em>, <em>elems</em>, <em>atNodes=False</em>, <em>treshold=None</em><big>)</big><a class="headerlink" href="#geomtools.averageNormals" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute average normals at all points of elems.</p>
<p>coords is a (ncoords,3) array of nodal coordinates.
elems is an (nel,nplex) array of element connectivity.</p>
<p>The default return value is an (nel,nplex,3) array with the averaged
unit normals in all points of all elements.
If atNodes == True, a more compact array with the unique averages
at the nodes is returned.</p>
</dd></dl>

<dl class="function">
<dt id="geomtools.triangleInCircle">
<tt class="descclassname">geomtools.</tt><tt class="descname">triangleInCircle</tt><big>(</big><em>x</em><big>)</big><a class="headerlink" href="#geomtools.triangleInCircle" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the incircles of the triangles x</p>
<p>The incircle of a triangle is the largest circle that can be inscribed
in the triangle.</p>
<p>x is a Coords array with shape (ntri,3,3) representing ntri triangles.</p>
<p>Returns a tuple r,C,n with the radii, Center and unit normals of the
incircles.</p>
</dd></dl>

<dl class="function">
<dt id="geomtools.triangleCircumCircle">
<tt class="descclassname">geomtools.</tt><tt class="descname">triangleCircumCircle</tt><big>(</big><em>x</em>, <em>bounding=False</em><big>)</big><a class="headerlink" href="#geomtools.triangleCircumCircle" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the circumcircles of the triangles x</p>
<p>x is a Coords array with shape (ntri,3,3) representing ntri triangles.</p>
<p>Returns a tuple r,C,n with the radii, Center and unit normals of the
circles going through the vertices of each triangle.</p>
<p>If bounding=True, this returns the triangle bounding circle.</p>
</dd></dl>

<dl class="function">
<dt id="geomtools.triangleBoundingCircle">
<tt class="descclassname">geomtools.</tt><tt class="descname">triangleBoundingCircle</tt><big>(</big><em>x</em><big>)</big><a class="headerlink" href="#geomtools.triangleBoundingCircle" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the bounding circles of the triangles x</p>
<p>The bounding circle is the smallest circle in the plane of the triangle
such that all vertices of the triangle are on or inside the circle.
If the triangle is acute, this is equivalent to the triangle&#8217;s
circumcircle. It the triangle is obtuse, the longest edge is the
diameter of the bounding circle.</p>
<p>x is a Coords array with shape (ntri,3,3) representing ntri triangles.</p>
<p>Returns a tuple r,C,n with the radii, Center and unit normals of the
bounding circles.</p>
</dd></dl>

<dl class="function">
<dt id="geomtools.triangleObtuse">
<tt class="descclassname">geomtools.</tt><tt class="descname">triangleObtuse</tt><big>(</big><em>x</em><big>)</big><a class="headerlink" href="#geomtools.triangleObtuse" title="Permalink to this definition">¶</a></dt>
<dd><p>Checks for obtuse triangles</p>
<p>x is a Coords array with shape (ntri,3,3) representing ntri triangles.</p>
<p>Returns an (ntri) array of True/False values indicating whether the
triangles are obtuse.</p>
</dd></dl>

<dl class="function">
<dt id="geomtools.displaceLines">
<tt class="descclassname">geomtools.</tt><tt class="descname">displaceLines</tt><big>(</big><em>A</em>, <em>N</em>, <em>C</em>, <em>d</em><big>)</big><a class="headerlink" href="#geomtools.displaceLines" title="Permalink to this definition">¶</a></dt>
<dd><p>Move all lines (A,N) over a distance a in the direction of point C.</p>
<p>A,N are arrays with points and directions defining the lines.
C is a point.
d is a scalar or a list of scalars.
All line elements of F are translated in the plane (line,C)
over a distance d in the direction of the point C.
Returns a new set of lines (A,N).</p>
</dd></dl>

<dl class="function">
<dt id="geomtools.segmentOrientation">
<tt class="descclassname">geomtools.</tt><tt class="descname">segmentOrientation</tt><big>(</big><em>vertices</em>, <em>vertices2=None</em>, <em>point=None</em><big>)</big><a class="headerlink" href="#geomtools.segmentOrientation" title="Permalink to this definition">¶</a></dt>
<dd><p>Determine the orientation of a set of line segments.</p>
<p>vertices and vertices2 are matching sets of points.
point is a single point.
All arguments are Coords objects.</p>
<p>Line segments run between corresponding points of vertices and vertices2.
If vertices2 is None, it is obtained by rolling the vertices one position
foreward, thus corresponding to a closed polygon through the vertices).
If point is None, it is taken as the center of vertices.</p>
<p>The orientation algorithm checks whether the line segments turn
positively around the point.</p>
<p>Returns an array with +1/-1 for positive/negative oriented segments.</p>
</dd></dl>

<dl class="function">
<dt id="geomtools.rotationAngle">
<tt class="descclassname">geomtools.</tt><tt class="descname">rotationAngle</tt><big>(</big><em>A</em>, <em>B</em>, <em>m=None</em>, <em>angle_spec=0.017453292519943295</em><big>)</big><a class="headerlink" href="#geomtools.rotationAngle" title="Permalink to this definition">¶</a></dt>
<dd><p>Return rotation angles and vectors for rotations of A to B.</p>
<p>A and B are (n,3) shaped arrays where each line represents a vector.
This function computes the rotation from each vector of A to the
corresponding vector of B.
If m is None, the return value is a tuple of an (n,) shaped array with
rotation angles (by default in degrees) and an (n,3) shaped array with
unit vectors along the rotation axis.
If m is a (n,3) shaped array with vectors along the rotation axis, the
return value is a (n,) shaped array with rotation angles.
Specify angle_spec=RAD to get the angles in radians.</p>
</dd></dl>

<dl class="function">
<dt id="geomtools.anyPerpendicularVector">
<tt class="descclassname">geomtools.</tt><tt class="descname">anyPerpendicularVector</tt><big>(</big><em>A</em><big>)</big><a class="headerlink" href="#geomtools.anyPerpendicularVector" title="Permalink to this definition">¶</a></dt>
<dd><p>Return arbitrary vectors perpendicular to vectors of A.</p>
<p>A is a (n,3) shaped array of vectors.
The return value is a (n,3) shaped array of perpendicular vectors.</p>
<p>The returned vector is always a vector in the x,y plane. If the original
is the z-axis, the result is the x-axis.</p>
</dd></dl>

<dl class="function">
<dt id="geomtools.perpendicularVector">
<tt class="descclassname">geomtools.</tt><tt class="descname">perpendicularVector</tt><big>(</big><em>A</em>, <em>B</em><big>)</big><a class="headerlink" href="#geomtools.perpendicularVector" title="Permalink to this definition">¶</a></dt>
<dd><p>Return vectors perpendicular on both A and B.</p>
</dd></dl>

<dl class="function">
<dt id="geomtools.projectionVOV">
<tt class="descclassname">geomtools.</tt><tt class="descname">projectionVOV</tt><big>(</big><em>A</em>, <em>B</em><big>)</big><a class="headerlink" href="#geomtools.projectionVOV" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the projection of vector of A on vector of B.</p>
</dd></dl>

<dl class="function">
<dt id="geomtools.projectionVOP">
<tt class="descclassname">geomtools.</tt><tt class="descname">projectionVOP</tt><big>(</big><em>A</em>, <em>n</em><big>)</big><a class="headerlink" href="#geomtools.projectionVOP" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the projection of vector of A on plane of B.</p>
</dd></dl>

<dl class="function">
<dt id="geomtools.baryCoords">
<tt class="descclassname">geomtools.</tt><tt class="descname">baryCoords</tt><big>(</big><em>S</em>, <em>P</em><big>)</big><a class="headerlink" href="#geomtools.baryCoords" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the barycentric coordinates of points  P wrt. simplexes S.</p>
<p>S is a (nel,nplex,3) shaped array of n-simplexes (n=nplex-1):
- 1-simplex: line segment
- 2-simplex: triangle
- 3-simplex: tetrahedron
P is a (npts,3), (npts,nel,3) or (npts,1,3) shaped array of points.</p>
<p>The return value is a (nplex,npts,nel) shaped array of barycentric coordinates.</p>
</dd></dl>

<dl class="function">
<dt id="geomtools.insideSimplex">
<tt class="descclassname">geomtools.</tt><tt class="descname">insideSimplex</tt><big>(</big><em>BC</em>, <em>bound=True</em><big>)</big><a class="headerlink" href="#geomtools.insideSimplex" title="Permalink to this definition">¶</a></dt>
<dd><p>Check if points are in simplexes.</p>
<p>BC is an array of barycentric coordinates (along the first axis),
which sum up to one.
If bound = True, a point lying on the boundary is considered to
be inside the simplex.</p>
</dd></dl>

<dl class="function">
<dt id="geomtools.insideTriangle">
<tt class="descclassname">geomtools.</tt><tt class="descname">insideTriangle</tt><big>(</big><em>x</em>, <em>P</em>, <em>method='bary'</em><big>)</big><a class="headerlink" href="#geomtools.insideTriangle" title="Permalink to this definition">¶</a></dt>
<dd><p>Checks whether the points P are inside triangles x.</p>
<p>x is a Coords array with shape (ntri,3,3) representing ntri triangles.
P is a Coords array with shape (npts,ntri,3) representing npts points
in each of the ntri planes of the triangles.
This function checks whether the points of P fall inside the corresponding
triangles.</p>
<p>Returns an array with (npts,ntri) bool values.</p>
</dd></dl>

</div>
</div>


          </div>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="inertia.html" title="19. inertia — Compute inertia related quantities of geometrical models."
             >next</a> |</li>
        <li class="right" >
          <a href="geomfile.html" title="17. geomfile — Handling pyFormex Geometry Files"
             >previous</a> |</li>
        <li><a href="../index.html">pyFormex 1.0.2~a1 documentation</a> &gt;</li>
          <li><a href="../refman.html" >pyFormex reference manual</a> &gt;</li> 
      </ul>
    </div>
    <div class="footer">
    <span class="left">
        &copy; Copyright 2004-2015, Benedict Verhegghe.
    </span>
      Last updated on May 22, 2015.
    <span class="right">
      Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 1.2.3.
    </span>
    </div>
  </body>
</html>