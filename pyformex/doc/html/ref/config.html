
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <!--
##
##  This file is part of the pyFormex project.
##  pyFormex is a tool for generating, manipulating and transforming 3D
##  geometrical models by sequences of mathematical operations.
##  Home page: http://pyformex.org
##  Project page:  http://savannah.nongnu.org/projects/pyformex/
##  Copyright (C) Benedict Verhegghe (benedict.verhegghe@ugent.be)
##  Distributed under the GNU General Public License version 3 or later.
##
##
##  This program is free software: you can redistribute it and/or modify
##  it under the terms of the GNU General Public License as published by
##  the Free Software Foundation, either version 3 of the License, or
##  (at your option) any later version.
##
##  This program is distributed in the hope that it will be useful,
##  but WITHOUT ANY WARRANTY; without even the implied warranty of
##  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
##  GNU General Public License for more details.
##
##  You should have received a copy of the GNU General Public License
##  along with this program.  If not, see http://www.gnu.org/licenses/.
##
-->
    <title>86. config — A general yet simple configuration class. &mdash; pyFormex 1.0.3-a2 documentation</title>

    
    <link rel="stylesheet" href="../_static/pyformex.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '1.0.3-a2',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  false
      };
    </script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <link rel="top" title="pyFormex 1.0.3-a2 documentation" href="../index.html" />
    <link rel="up" title="pyFormex reference manual" href="../refman.html" />
    <link rel="next" title="87. flatkeydb — Flat Text File Database." href="flatkeydb.html" />
    <link rel="prev" title="85. collection — Tools for handling collections of elements belonging to multiple parts." href="collection.html" />
<link rel="icon" type="image/png" href="_static/pyformex_fav.png" />

  </head>
  <body role="document">

<div class="header">
  <a href="http://pyformex.org">
  <img src="http://www.nongnu.org/pyformex/_static/scallop_dome_small.png" alt="scallop dome" border="0" hspace="20" vspace="12" align="left" />
  <img src="http://www.nongnu.org/pyformex/_static/pyformex-logo-2.png" alt="pyformex logo" border="0" hspace="10" vspace="8" align="left" />
  </a>
</div>

    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="flatkeydb.html" title="87. flatkeydb — Flat Text File Database."
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="collection.html" title="85. collection — Tools for handling collections of elements belonging to multiple parts."
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../index.html">pyFormex 1.0.3-a2 documentation</a> &gt;</li>
          <li class="nav-item nav-item-1"><a href="../refman.html" accesskey="U">pyFormex reference manual</a> &gt;</li> 
      </ul>
    </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<!-- PYFORMEX_WEBSITE
<div align="center">

<form action="https://www.paypal.com/cgi-bin/webscr" method="post">
<input type="hidden" name="cmd" value="_s-xclick"/>
<input type="hidden" name="hosted_button_id" value="P7J4AM4QULB4Q"/>
<input type="image" src="https://www.paypal.com/en_US/BE/i/btn/btn_donateCC_LG.gif" name="submit" alt="PayPal - The safer, easier way to pay online!"/>
<img alt="" border="0" src="https://www.paypal.com/nl_NL/i/scr/pixel.gif" width="1" height="1"/>
</form>

</div>
PYFORMEX_WEBSITE -->
   
  <h3><a href="../index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">86. <code class="docutils literal"><span class="pre">config</span></code> &#8212; A general yet simple configuration class.</a><ul>
<li><a class="reference internal" href="#classes-defined-in-module-config">86.1. Classes defined in module config</a></li>
<li><a class="reference internal" href="#functions-defined-in-module-config">86.2. Functions defined in module config</a></li>
</ul>
</li>
</ul>


  <h4>Previous topic</h4>
  <p class="topless"><a href="collection.html"
                        title="previous chapter">85. <code class="docutils literal"><span class="pre">collection</span></code> &#8212; Tools for handling collections of elements belonging to multiple parts.</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="flatkeydb.html"
                        title="next chapter">87. <code class="docutils literal"><span class="pre">flatkeydb</span></code> &#8212; Flat Text File Database.</a></p>
  
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <form class="search" action="../search.html" method="get">
      <div><input type="text" name="q" /></div>
      <div><input type="submit" value="Go" /></div>
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>

<!-- PYFORMEX_WEBSITE
<div align="center">
  <p>
  <a href="http://www.fsf.org/register_form?referrer=8491"><img src="http://www.nongnu.org/pyformex/_static/fsf-member8491.png" alt="[FSF Associate Member]" width="89" height="31"  /></a>
  </p>
  <p>
    <a href="http://validator.w3.org/check?uri=referer"><img
      src="http://www.w3.org/Icons/valid-xhtml10" alt="Valid XHTML 1.0 Transitional" height="31" width="88" /></a>
  </p>
</div>
PYFORMEX_WEBSITE -->

        </div>
      </div>

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="module-config">
<span id="config-a-general-yet-simple-configuration-class"></span><span id="sec-ref-config"></span><h1>86. <a class="reference internal" href="#module-config" title="config: A general yet simple configuration class."><code class="xref py py-mod docutils literal"><span class="pre">config</span></code></a> &#8212; A general yet simple configuration class.<a class="headerlink" href="#module-config" title="Permalink to this headline">¶</a></h1>
<div class="line-block">
<div class="line">(C) 2005 Benedict Verhegghe</div>
<div class="line">Distributed under the GNU GPL version 3 or later</div>
</div>
<dl class="docutils">
<dt>Why</dt>
<dd>I wrote this simple class because I wanted to use Python
expressions in my configuration files. This is so much more fun
than using .INI style config files.  While there are some other
Python config modules available on the web, I couldn&#8217;t find one
that suited my needs and my taste: either they are intended for
more complex configuration needs than mine, or they do not work
with the simple Python syntax I expected.</dd>
<dt>What</dt>
<dd>Our Config class is just a normal Python dictionary which can hold
anything.  Fields can be accessed either as dictionary lookup
(config[&#8216;foo&#8217;]) or as object attributes (config.foo).  The class
provides a function for reading the dictionary from a flat text
(multiline string or file). I will always use the word &#8216;file&#8217;
hereafter, because that is what you usually will read the
configuration from.  Your configuration file can have named
sections. Sections are stored as other Python dicts inside the top
Config dictionary. The current version is limited to one level of
sectioning.</dd>
</dl>
<div class="section" id="classes-defined-in-module-config">
<h2>86.1. Classes defined in module config<a class="headerlink" href="#classes-defined-in-module-config" title="Permalink to this headline">¶</a></h2>
<dl class="class">
<dt id="config.Config">
<em class="property">class </em><code class="descclassname">config.</code><code class="descname">Config</code><span class="sig-paren">(</span><em>data={}</em>, <em>default=None</em><span class="sig-paren">)</span><a class="headerlink" href="#config.Config" title="Permalink to this definition">¶</a></dt>
<dd><p>A configuration class allowing Python expressions in the input.</p>
<p>The configuration settings are stored in the __dict__ of a Python
object.  An item &#8216;foo&#8217; in the configuration &#8216;config&#8217; can be accessed
either as dictionary lookup (<code class="docutils literal"><span class="pre">config['foo']</span></code>) or as object attribute
(<code class="docutils literal"><span class="pre">config.foo</span></code>).</p>
<p>The configuration object can be initialized from a multiline string or
a text file (or any other object that allows iterating over strings).</p>
<p>The format of the config file/text is described hereafter.</p>
<p>All config lines should have the format: key = value, where key is a
string and value is a Python expression The first &#8216;=&#8217; character on the
line is the delimiter between key and value.  Blanks around both the
key and the value are stripped.  The value is then evaluated as a
Python expression and stored in a variable with name specified by the
key. This variable is available for use in subsequent configuration
lines. It is an error to use a variable before it is defined.  The
key,value pair is also stored in the config dictionary, unless the key
starts with an underscore (&#8216;_&#8217;): this provides for local variables.</p>
<p>Lines starting with &#8216;#&#8217; are comments and are ignored, as are empty
and blank lines.  Lines ending with &#8216;&#8217; are continued on the next
line.  A line starting with &#8216;[&#8216; starts a new section. A section is
nothing more than a Python dictionary inside the config
dictionary. The section name is delimited by &#8216;[&#8216;and &#8216;]&#8217;. All
subsequent lines will be stored in the section dictionary instead
of the toplevel dictionary.</p>
<p>All other lines are executed as python statements. This allows
e.g. for importing modules.</p>
<p>Whole dictionaries can be inserted at once in the config with the
update() function.</p>
<p>All defined variables while reading config files remain available
for use in the config file statements, even over multiple calls to
the read() function. Variables inserted with addSection() will not
be available as individual variables though, but can be access as
<code class="docutils literal"><span class="pre">self['name']</span></code>.</p>
<p>As an example, if your config file looks like:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">aa</span> <span class="o">=</span> <span class="s1">&#39;bb&#39;</span>
<span class="n">bb</span> <span class="o">=</span> <span class="n">aa</span>
<span class="p">[</span><span class="n">cc</span><span class="p">]</span>
<span class="n">aa</span> <span class="o">=</span> <span class="s1">&#39;aa&#39;</span>
<span class="n">_n</span> <span class="o">=</span> <span class="mi">3</span>
<span class="n">rng</span> <span class="o">=</span> <span class="nb">range</span><span class="p">(</span><span class="n">_n</span><span class="p">)</span>
</pre></div>
</div>
<p>the resulting configuration dictionary is
<code class="docutils literal"><span class="pre">{'aa':</span> <span class="pre">'bb',</span> <span class="pre">'bb':</span> <span class="pre">'bb',</span> <span class="pre">'cc':</span> <span class="pre">{'aa':</span> <span class="pre">'aa',</span> <span class="pre">'rng':</span> <span class="pre">[0,</span> <span class="pre">1,</span> <span class="pre">2]}}</span></code></p>
<p>As far as the resulting Config contents is concerned, the following are
equivalent:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">C</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="s1">&#39;key&#39;</span><span class="p">:</span><span class="s1">&#39;value&#39;</span><span class="p">})</span>
<span class="n">C</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="s2">&quot;key=&#39;value&#39;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>There is an important difference though: the second line will make a
variable key (with value &#8216;value&#8217;) available in subsequent Config read()
method calls.</p>
<dl class="method">
<dt id="config.Config.update">
<code class="descname">update</code><span class="sig-paren">(</span><em>data={}</em>, <em>name=None</em>, <em>removeLocals=False</em><span class="sig-paren">)</span><a class="headerlink" href="#config.Config.update" title="Permalink to this definition">¶</a></dt>
<dd><p>Add a dictionary to the Config object.</p>
<p>The data, if specified, should be a valid Python dict.
If no name is specified, the data are added to the top dictionary
and will become attributes.
If a name is specified, the data are added to the named attribute,
which should be a dictionary. If the name does not specify a
dictionary, an empty one is created, deleting the existing attribute.</p>
<p>If a name is specified, but no data, the effect is to add a new
empty dictionary (section) with that name.</p>
<p>If removeLocals is set, keys starting with &#8216;_&#8217; are removed from the
data before updating the dictionary and not
included in the config. This behaviour can be changed by setting
removeLocals to false.</p>
</dd></dl>

<dl class="method">
<dt id="config.Config.read">
<code class="descname">read</code><span class="sig-paren">(</span><em>fil</em>, <em>debug=False</em><span class="sig-paren">)</span><a class="headerlink" href="#config.Config.read" title="Permalink to this definition">¶</a></dt>
<dd><p>Read a configuration from a file or text</p>
<p><cite>fil</cite> is a sequence of strings. Any type that allows a loop like
<code class="docutils literal"><span class="pre">for</span> <span class="pre">line</span> <span class="pre">in</span> <span class="pre">fil:</span></code>
to iterate over its text lines will do. This could be a file type, or
a multiline text after splitting on &#8216;n&#8217;.</p>
<p>The function will try to react intelligently if a string is passed as
argument. If the string contains at least one &#8216;n&#8217;, it will be
interpreted as a multiline string and be splitted on &#8216;n&#8217;.
Else, the string will be considered and a file with that name will
be opened. It is an error if the file does not exist or can not be
opened.</p>
<p>The function returns self, so that you can write: cfg = Config().</p>
</dd></dl>

<dl class="method">
<dt id="config.Config.write">
<code class="descname">write</code><span class="sig-paren">(</span><em>filename</em>, <em>header='# Config written by pyFormex    -*- PYTHON -*-\n\n'</em>, <em>trailer='\n# End of config\n'</em><span class="sig-paren">)</span><a class="headerlink" href="#config.Config.write" title="Permalink to this definition">¶</a></dt>
<dd><p>Write the config to the given file</p>
<p>The configuration data will be written to the file with the given name
in a text format that is both readable by humans and by the
Config.read() method.</p>
<p>The header and trailer arguments are strings that will be added at
the start and end of the outputfile. Make sure they are valid
Python statements (or comments) and that they contain the needed
line separators, if you want to be able to read it back.</p>
</dd></dl>

<dl class="method">
<dt id="config.Config.keys">
<code class="descname">keys</code><span class="sig-paren">(</span><em>descend=True</em><span class="sig-paren">)</span><a class="headerlink" href="#config.Config.keys" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the keys in the config.</p>
<p>By default this descends one level of Dicts.</p>
</dd></dl>

<dl class="method">
<dt id="config.Config.get">
<code class="descname">get</code><span class="sig-paren">(</span><em>key</em>, <em>default</em><span class="sig-paren">)</span><a class="headerlink" href="#config.Config.get" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the value for key or a default.</p>
<p>This is the equivalent of the dict get method, except that it
returns only the default value if the key was not found in self,
and there is no _default_ method or it raised a KeyError.</p>
</dd></dl>

<dl class="method">
<dt id="config.Config.setdefault">
<code class="descname">setdefault</code><span class="sig-paren">(</span><em>key</em>, <em>default</em><span class="sig-paren">)</span><a class="headerlink" href="#config.Config.setdefault" title="Permalink to this definition">¶</a></dt>
<dd><p>Replaces the setdefault function of a normal dictionary.</p>
<p>This is the same as the get method, except that it also sets the
default value if get found a KeyError.</p>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="functions-defined-in-module-config">
<h2>86.2. Functions defined in module config<a class="headerlink" href="#functions-defined-in-module-config" title="Permalink to this headline">¶</a></h2>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="flatkeydb.html" title="87. flatkeydb — Flat Text File Database."
             >next</a> |</li>
        <li class="right" >
          <a href="collection.html" title="85. collection — Tools for handling collections of elements belonging to multiple parts."
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../index.html">pyFormex 1.0.3-a2 documentation</a> &gt;</li>
          <li class="nav-item nav-item-1"><a href="../refman.html" >pyFormex reference manual</a> &gt;</li> 
      </ul>
    </div>
    <div class="footer">
    <span class="left">
        &copy; Copyright 2004-2015, Benedict Verhegghe.
    </span>
      Last updated on Sep 28, 2016.
    <span class="right">
      Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 1.4.5.
    </span>
    </div>
  </body>
</html>