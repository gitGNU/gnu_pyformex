

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"> 
<!-- 
##
##  This file is part of the pyFormex project.
##  pyFormex is a tool for generating, manipulating and transforming 3D
##  geometrical models by sequences of mathematical operations.
##  Home page: http://pyformex.org
##  Project page:  http://savannah.nongnu.org/projects/pyformex/
##  Copyright (C) Benedict Verhegghe (benedict.verhegghe@ugent.be) 
##  Distributed under the GNU General Public License version 3 or later.
##
##
##  This program is free software: you can redistribute it and/or modify
##  it under the terms of the GNU General Public License as published by
##  the Free Software Foundation, either version 3 of the License, or
##  (at your option) any later version.
##
##  This program is distributed in the hope that it will be useful,
##  but WITHOUT ANY WARRANTY; without even the implied warranty of
##  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
##  GNU General Public License for more details.
##
##  You should have received a copy of the GNU General Public License
##  along with this program.  If not, see http://www.gnu.org/licenses/.
##
-->


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>9. connectivity — A class and functions for handling nodal connectivity. &mdash; pyFormex 1.0.2-a6 documentation</title>

    
    <link rel="stylesheet" href="../_static/pyformex.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '1.0.2-a6',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  false
      };
    </script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <link rel="top" title="pyFormex 1.0.2-a6 documentation" href="../index.html" />
    <link rel="up" title="pyFormex reference manual" href="../refman.html" />
    <link rel="next" title="10. elements — Definition of elements." href="elements.html" />
    <link rel="prev" title="8. geometry — A generic interface to the Coords transformation methods" href="geometry.html" />
<link rel="icon" type="image/png" href="_static/pyformex_fav.png" />

  </head>
  <body role="document">

<div class="header">
  <a href="http://pyformex.org">
  <img src="http://www.nongnu.org/pyformex/_static/scallop_dome_small.png" alt="scallop dome" border="0" hspace="20" vspace="12" align="left" />
  <img src="http://www.nongnu.org/pyformex/_static/pyformex-logo-2.png" alt="pyformex logo" border="0" hspace="10" vspace="8" align="left" />
  </a>
</div>

    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="elements.html" title="10. elements — Definition of elements."
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="geometry.html" title="8. geometry — A generic interface to the Coords transformation methods"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../index.html">pyFormex 1.0.2-a6 documentation</a> &gt;</li>
          <li class="nav-item nav-item-1"><a href="../refman.html" accesskey="U">pyFormex reference manual</a> &gt;</li> 
      </ul>
    </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<div align="center">

<form action="https://www.paypal.com/cgi-bin/webscr" method="post">
<input type="hidden" name="cmd" value="_s-xclick"/>
<input type="hidden" name="hosted_button_id" value="P7J4AM4QULB4Q"/>
<input type="image" src="https://www.paypal.com/en_US/BE/i/btn/btn_donateCC_LG.gif" name="submit" alt="PayPal - The safer, easier way to pay online!"/>
<img alt="" border="0" src="https://www.paypal.com/nl_NL/i/scr/pixel.gif" width="1" height="1"/>
</form>

</div>
   
  <h3><a href="../index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">9. <code class="docutils literal"><span class="pre">connectivity</span></code> &#8212; A class and functions for handling nodal connectivity.</a><ul>
<li><a class="reference internal" href="#classes-defined-in-module-connectivity">9.1. Classes defined in module connectivity</a></li>
<li><a class="reference internal" href="#functions-defined-in-module-connectivity">9.2. Functions defined in module connectivity</a></li>
</ul>
</li>
</ul>


  <h4>Previous topic</h4>
  <p class="topless"><a href="geometry.html"
                        title="previous chapter">8. <code class="docutils literal"><span class="pre">geometry</span></code> &#8212; A generic interface to the Coords transformation methods</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="elements.html"
                        title="next chapter">10. <code class="docutils literal"><span class="pre">elements</span></code> &#8212; Definition of elements.</a></p>
  
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <form class="search" action="../search.html" method="get">
      <div><input type="text" name="q" /></div>
      <div><input type="submit" value="Go" /></div>
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>

<div align="center">
  <p>
  <a href="http://www.fsf.org/register_form?referrer=8491"><img src="http://www.nongnu.org/pyformex/_static/fsf-member8491.png" alt="[FSF Associate Member]" width="89" height="31"  /></a>
  </p>
  <p>
    <a href="http://validator.w3.org/check?uri=referer"><img
      src="http://www.w3.org/Icons/valid-xhtml10" alt="Valid XHTML 1.0 Transitional" height="31" width="88" /></a>
  </p>
</div>

        </div>
      </div>

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="module-connectivity">
<span id="connectivity-a-class-and-functions-for-handling-nodal-connectivity"></span><span id="sec-ref-connectivity"></span><h1>9. <a class="reference internal" href="#module-connectivity" title="connectivity: A class and functions for handling nodal connectivity."><code class="xref py py-mod docutils literal"><span class="pre">connectivity</span></code></a> &#8212; A class and functions for handling nodal connectivity.<a class="headerlink" href="#module-connectivity" title="Permalink to this headline">¶</a></h1>
<p>This module defines a specialized array class for representing nodal
connectivity. This is e.g. used in mesh models, where geometry is
represented by a set of numbered points (nodes) and the geometric elements
are described by refering to the node numbers.
In a mesh model, points common to adjacent elements are unique, and
adjacency of elements can easily be detected from common node numbers.</p>
<div class="section" id="classes-defined-in-module-connectivity">
<h2>9.1. Classes defined in module connectivity<a class="headerlink" href="#classes-defined-in-module-connectivity" title="Permalink to this headline">¶</a></h2>
<dl class="class">
<dt id="connectivity.Connectivity">
<em class="property">class </em><code class="descclassname">connectivity.</code><code class="descname">Connectivity</code><a class="headerlink" href="#connectivity.Connectivity" title="Permalink to this definition">¶</a></dt>
<dd><p>A class for handling element/node connectivity.</p>
<p>A connectivity object is a 2-dimensional integer array with all
non-negative values. Each row of the array defines an element by listing
the numbers of its lower entity types. A typical use is a <code class="xref py py-class docutils literal"><span class="pre">Mesh</span></code>
object, where each element is defined in function of its nodes.
While in a Mesh the word &#8216;node&#8217; will normally refer to a geometrical
point, here we will use &#8216;node&#8217; for the lower entity whatever its nature
is. It doesn&#8217;t even have to be a geometrical entity.</p>
<p>The current implementation limits a Connectivity object to numbers that
are smaller than 2**31.</p>
<p>In a row (element), the same node number may occur more than once, though
usually all numbers in a row are different. Rows containing duplicate
numbers are called <cite>degenerate</cite> elements.
Rows containing the same node sets, albeit different permutations thereof,
are called duplicates.</p>
<p>A new Connectivity object is created with the following syntax</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">Connectivity</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="p">[],</span><span class="n">dtyp</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span><span class="n">copy</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span><span class="n">nplex</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">eltype</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
</pre></div>
</div>
<p>Parameters:</p>
<ul class="simple">
<li><cite>data</cite>: should be compatible with an integer array with shape
<cite>(nelems,nplex)</cite>, where <cite>nelems</cite> is the number of elements and
<cite>nplex</cite> is the plexitude of the elements.</li>
<li><cite>dtype</cite>: can be specified to force an integer type but is set by
default from the passed <cite>data</cite>.</li>
<li><cite>copy</cite>: can be set True to force copying the data. By default, the
specified data will be used without copying, if possible.</li>
<li><cite>nplex</cite>: can be specified to force a check on the plexitude of the
data, or to set the plexitude for an empty Connectivity.
An error will be raised if the specified data do not match the
specified plexitude. If an <cite>eltype</cite> is specified, the plexitude of
the element type will override this value.</li>
<li><cite>eltype</cite>: an Element type (a subclass of <code class="xref py py-class docutils literal"><span class="pre">Element</span></code>) or the name
of an Element type, or None (default). If the Connectivity will be used
to create a Mesh, the proper element type or name should be set: either
here or at Mesh creation time. If the Connectivity will be used for other
purposes, the element type may be not important.</li>
</ul>
<p>Example:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">Connectivity</span><span class="p">([[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">],[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">],[</span><span class="mi">0</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">2</span><span class="p">],[</span><span class="mi">0</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">3</span><span class="p">]]))</span>
<span class="go">[[0 1 2]</span>
<span class="go"> [0 1 3]</span>
<span class="go"> [0 3 2]</span>
<span class="go"> [0 5 3]]</span>
</pre></div>
</div>
<dl class="method">
<dt id="connectivity.Connectivity.nelems">
<code class="descname">nelems</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#connectivity.Connectivity.nelems" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the number of elements in the Connectivity table.</p>
<p>Example:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">Connectivity</span><span class="p">([[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">],[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">],[</span><span class="mi">0</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">2</span><span class="p">],[</span><span class="mi">0</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">3</span><span class="p">]])</span><span class="o">.</span><span class="n">nelems</span><span class="p">()</span>
<span class="go">4</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="connectivity.Connectivity.maxnodes">
<code class="descname">maxnodes</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#connectivity.Connectivity.maxnodes" title="Permalink to this definition">¶</a></dt>
<dd><p>Return an upper limit for number of nodes in the connectivity.</p>
<p>This returns the highest node number plus one.</p>
</dd></dl>

<dl class="method">
<dt id="connectivity.Connectivity.nnodes">
<code class="descname">nnodes</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#connectivity.Connectivity.nnodes" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the actual number of nodes in the connectivity.</p>
<p>This returns the count of the unique node numbers.</p>
</dd></dl>

<dl class="method">
<dt id="connectivity.Connectivity.nplex">
<code class="descname">nplex</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#connectivity.Connectivity.nplex" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the plexitude of the elements in the Connectivity table.</p>
<p>Example:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">Connectivity</span><span class="p">([[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">],[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">],[</span><span class="mi">0</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">2</span><span class="p">],[</span><span class="mi">0</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">3</span><span class="p">]])</span><span class="o">.</span><span class="n">nplex</span><span class="p">()</span>
<span class="go">3</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="connectivity.Connectivity.report">
<code class="descname">report</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#connectivity.Connectivity.report" title="Permalink to this definition">¶</a></dt>
<dd><p>Format a Connectivity table</p>
</dd></dl>

<dl class="method">
<dt id="connectivity.Connectivity.testDegenerate">
<code class="descname">testDegenerate</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#connectivity.Connectivity.testDegenerate" title="Permalink to this definition">¶</a></dt>
<dd><p>Flag the degenerate elements (rows).</p>
<p>A degenerate element is a row which contains at least two
equal values.</p>
<p>Returns a boolean array with shape (self.nelems(),).
The True values flag the degenerate rows.</p>
<p>Example:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">Connectivity</span><span class="p">([[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">],[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">],[</span><span class="mi">0</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">2</span><span class="p">]])</span><span class="o">.</span><span class="n">testDegenerate</span><span class="p">()</span>
<span class="go">array([False,  True, False], dtype=bool)</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="connectivity.Connectivity.listDegenerate">
<code class="descname">listDegenerate</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#connectivity.Connectivity.listDegenerate" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a list with the numbers of the degenerate elements.</p>
<p>Example:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">Connectivity</span><span class="p">([[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">],[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">],[</span><span class="mi">0</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">2</span><span class="p">]])</span><span class="o">.</span><span class="n">listDegenerate</span><span class="p">()</span>
<span class="go">array([1])</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="connectivity.Connectivity.listNonDegenerate">
<code class="descname">listNonDegenerate</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#connectivity.Connectivity.listNonDegenerate" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a list with the numbers of the non-degenerate elements.</p>
<p>Example:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">Connectivity</span><span class="p">([[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">],[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">],[</span><span class="mi">0</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">2</span><span class="p">]])</span><span class="o">.</span><span class="n">listNonDegenerate</span><span class="p">()</span>
<span class="go">array([0, 2])</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="connectivity.Connectivity.removeDegenerate">
<code class="descname">removeDegenerate</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#connectivity.Connectivity.removeDegenerate" title="Permalink to this definition">¶</a></dt>
<dd><p>Remove the degenerate elements from a Connectivity table.</p>
<p>Degenerate elements are rows with repeating values.</p>
<p>Returns a Connectivity with the degenerate elements removed.</p>
<p>Example:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">Connectivity</span><span class="p">([[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">],[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">],[</span><span class="mi">0</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">2</span><span class="p">]])</span><span class="o">.</span><span class="n">removeDegenerate</span><span class="p">()</span>
<span class="go">Connectivity([[0, 1, 2],</span>
<span class="go">       [0, 3, 2]])</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="connectivity.Connectivity.reduceDegenerate">
<code class="descname">reduceDegenerate</code><span class="sig-paren">(</span><em>target=None</em><span class="sig-paren">)</span><a class="headerlink" href="#connectivity.Connectivity.reduceDegenerate" title="Permalink to this definition">¶</a></dt>
<dd><p>Reduce degenerate elements to lower plexitude elements.</p>
<p>This will try to reduce the degenerate elements of the Connectivity
to a lower plexitude. This is only possible if an element type
was set in the Connectivity. This function uses the data of
the Element database in <a class="reference internal" href="elements.html#module-elements" title="elements: Definition of elements."><code class="xref py py-mod docutils literal"><span class="pre">elements</span></code></a>.</p>
<p>If a target element type is given, only the reductions to that element
type are performed. Else, all the target element types for which
a reduction scheme is available, will be tried.</p>
<p>Returns:</p>
<blockquote>
<div>A list of Connectivities of which the first one contains
the originally non-degenerate elements and the last one contains
the elements that could not be reduced and may be empty.
If the original Connectivity does not have an element type set,
or the element type does not have any reduction schemes defined,
a list with only the original is returned.</div></blockquote>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">If the Connectivity is part of a Mesh, you should use the
Mesh.reduceDegenerate method instead, as that one will preserve
the property numbers into the resulting Meshes.</p>
</div>
<p>Example:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">C</span> <span class="o">=</span> <span class="n">Connectivity</span><span class="p">([[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">],[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">],[</span><span class="mi">0</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">2</span><span class="p">]],</span><span class="n">eltype</span><span class="o">=</span><span class="s1">&#39;line3&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">C</span><span class="o">.</span><span class="n">reduceDegenerate</span><span class="p">())</span>
<span class="go">[Connectivity([[0, 1]]), Connectivity([[0, 1, 2],</span>
<span class="go">       [0, 3, 2]])]</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="connectivity.Connectivity.testDuplicate">
<code class="descname">testDuplicate</code><span class="sig-paren">(</span><em>permutations=True</em>, <em>return_multiplicity=False</em><span class="sig-paren">)</span><a class="headerlink" href="#connectivity.Connectivity.testDuplicate" title="Permalink to this definition">¶</a></dt>
<dd><p>Test the Connectivity list for duplicates.</p>
<p>By default, duplicates are elements that consist of the same set of
nodes, in any particular order. Setting permutations to False
will only find the duplicate rows that have matching values at
every position.</p>
<p>Returns a tuple of two arrays and optionally a dictionary:</p>
<ul class="simple">
<li>an index used to sort the elements</li>
<li>a flags array with the value True for indices of the unique elements
and False for those of the duplicates.</li>
<li>if return_multiplicity is True, returns also an extra dict with
multiplicities as keys and a list of elements as value.</li>
</ul>
<p>Example:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">conn</span> <span class="o">=</span> <span class="n">Connectivity</span><span class="p">([[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">],[</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">0</span><span class="p">],[</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">],[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">],[</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">],[</span><span class="mi">0</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">2</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">conn</span><span class="p">)</span>
<span class="go">[[0 1 3]</span>
<span class="go"> [2 3 0]</span>
<span class="go"> [0 2 3]</span>
<span class="go"> [0 1 2]</span>
<span class="go"> [0 2 1]</span>
<span class="go"> [0 3 2]]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ind</span><span class="p">,</span><span class="n">ok</span><span class="p">,</span><span class="n">D</span> <span class="o">=</span> <span class="n">conn</span><span class="o">.</span><span class="n">testDuplicate</span><span class="p">(</span><span class="n">return_multiplicity</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">ind</span><span class="p">,</span><span class="n">ok</span><span class="p">)</span>
<span class="go">[3 4 0 1 2 5] [ True False  True  True False False]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">ok</span><span class="o">.</span><span class="n">cumsum</span><span class="p">())</span>
<span class="go">[1 1 2 3 3 3]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">D</span><span class="p">)</span>
<span class="go">{1: array([0]), 2: array([3, 4]), 3: array([1, 2, 5])}</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="connectivity.Connectivity.listUnique">
<code class="descname">listUnique</code><span class="sig-paren">(</span><em>permutations=True</em><span class="sig-paren">)</span><a class="headerlink" href="#connectivity.Connectivity.listUnique" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a list with the numbers of the unique elements.</p>
<p>Example:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">Connectivity</span><span class="p">([[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">],[</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">],[</span><span class="mi">0</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">2</span><span class="p">]])</span><span class="o">.</span><span class="n">listUnique</span><span class="p">()</span>
<span class="go">array([0, 2])</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="connectivity.Connectivity.listDuplicate">
<code class="descname">listDuplicate</code><span class="sig-paren">(</span><em>permutations=True</em><span class="sig-paren">)</span><a class="headerlink" href="#connectivity.Connectivity.listDuplicate" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a list with the numbers of the duplicate elements.</p>
<p>Example:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">Connectivity</span><span class="p">([[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">],[</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">],[</span><span class="mi">0</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">2</span><span class="p">]])</span><span class="o">.</span><span class="n">listDuplicate</span><span class="p">()</span>
<span class="go">array([1])</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="connectivity.Connectivity.removeDuplicate">
<code class="descname">removeDuplicate</code><span class="sig-paren">(</span><em>permutations=True</em><span class="sig-paren">)</span><a class="headerlink" href="#connectivity.Connectivity.removeDuplicate" title="Permalink to this definition">¶</a></dt>
<dd><p>Remove duplicate elements from a Connectivity list.</p>
<p>By default, duplicates are elements that consist of the same set of
nodes, in any particular order. Setting permutations to False
will only remove the duplicate rows that have matching values at
matching positions.</p>
<p>Returns a new Connectivity with the duplicate elements removed.</p>
<p>Example:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">Connectivity</span><span class="p">([[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">],[</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">],[</span><span class="mi">0</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">2</span><span class="p">]])</span><span class="o">.</span><span class="n">removeDuplicate</span><span class="p">()</span>
<span class="go">Connectivity([[0, 1, 2],</span>
<span class="go">       [0, 3, 2]])</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="connectivity.Connectivity.reorder">
<code class="descname">reorder</code><span class="sig-paren">(</span><em>order='nodes'</em><span class="sig-paren">)</span><a class="headerlink" href="#connectivity.Connectivity.reorder" title="Permalink to this definition">¶</a></dt>
<dd><p>Reorder the elements of a Connectivity in a specified order.</p>
<p>This does not actually reorder the elements itself, but returns
an index with the order of the rows (elements) in the connectivity
table that meets the specified requirements.</p>
<p>Parameters:</p>
<ul>
<li><p class="first"><cite>order</cite>: specifies how to reorder the elements. It is either one
of the special string values defined below, or else it is an index
with length equal to the number of elements. The index should be
a permutation of the numbers in <code class="docutils literal"><span class="pre">range(self.nelems()</span></code>. Each value
gives of the number of the old element that should be placed at
this position. Thus, the order values are the old element numbers
on the position of the new element number.</p>
<p><cite>order</cite> can also take one of the following predefined values,
resulting in the corresponding renumbering scheme being generated:</p>
<ul class="simple">
<li>&#8216;nodes&#8217;: the elements are renumbered in order of their appearance
in the inverse index, i.e. first are the elements connected to
node 0, then the as yet unlisted elements connected to node 1, etc.</li>
<li>&#8216;random&#8217;: the elements are randomly renumbered.</li>
<li>&#8216;reverse&#8217;: the elements are renumbered in reverse order.</li>
</ul>
</li>
</ul>
<p>Returns:</p>
<blockquote>
<div>A 1-D integer array which is a permutation of
<code class="docutils literal"><span class="pre">arange(self.nelems()</span></code>, such that taking the elements in this order
will produce a Connectivity reordered as requested. In case an
explicit order was specified as input, this order is returned after
checking that it is indeed a permutation of <code class="docutils literal"><span class="pre">range(self.nelems()</span></code>.</div></blockquote>
<p>Example:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">A</span> <span class="o">=</span> <span class="n">Connectivity</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">],[</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">],[</span><span class="mi">3</span><span class="p">,</span><span class="mi">0</span><span class="p">],[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">A</span><span class="p">[</span><span class="n">A</span><span class="o">.</span><span class="n">reorder</span><span class="p">(</span><span class="s1">&#39;reverse&#39;</span><span class="p">)]</span>
<span class="go">Connectivity([[0, 1],</span>
<span class="go">       [3, 0],</span>
<span class="go">       [2, 3],</span>
<span class="go">       [1, 2]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">A</span><span class="o">.</span><span class="n">reorder</span><span class="p">(</span><span class="s1">&#39;nodes&#39;</span><span class="p">)</span>
<span class="go">array([3, 2, 0, 1])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">A</span><span class="p">[</span><span class="n">A</span><span class="o">.</span><span class="n">reorder</span><span class="p">([</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">])]</span>
<span class="go">Connectivity([[3, 0],</span>
<span class="go">       [0, 1],</span>
<span class="go">       [1, 2],</span>
<span class="go">       [2, 3]])</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="connectivity.Connectivity.renumber">
<code class="descname">renumber</code><span class="sig-paren">(</span><em>start=0</em><span class="sig-paren">)</span><a class="headerlink" href="#connectivity.Connectivity.renumber" title="Permalink to this definition">¶</a></dt>
<dd><p>Renumber the nodes to a consecutive integer range.</p>
<p>The node numbers in the table are changed thus that they
form a consecutive integer range starting from the specified
value.</p>
<p>Returns a tuple:</p>
<ul class="simple">
<li><cite>elems</cite>: the renumbered connectivity</li>
<li><cite>oldnrs</cite>: The sorted list of unique (old) node numbers. The new
node numbers are assigned in order of increasing old node numbers,
thus the old node number for new node number <cite>i</cite> can be found
at position <cite>i - start</cite>.</li>
</ul>
<p>Example:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">e</span><span class="p">,</span><span class="n">n</span> <span class="o">=</span> <span class="n">Connectivity</span><span class="p">([[</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">],[</span><span class="mi">1</span><span class="p">,</span><span class="mi">4</span><span class="p">],[</span><span class="mi">4</span><span class="p">,</span><span class="mi">2</span><span class="p">]])</span><span class="o">.</span><span class="n">renumber</span><span class="p">(</span><span class="mi">7</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">e</span><span class="p">,</span><span class="n">n</span><span class="p">)</span>
<span class="go">[[ 7  9]</span>
<span class="go"> [ 8 10]</span>
<span class="go"> [10  9]] [0 1 2 4]</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="connectivity.Connectivity.inverse">
<code class="descname">inverse</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#connectivity.Connectivity.inverse" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the inverse index of a Connectivity table.</p>
<p>Returns the inverse index of the Connectivity, as computed
by <a class="reference internal" href="arraytools.html#arraytools.inverseIndex" title="arraytools.inverseIndex"><code class="xref py py-func docutils literal"><span class="pre">arraytools.inverseIndex()</span></code></a>.</p>
<p>Example:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">Connectivity</span><span class="p">([[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">],[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">4</span><span class="p">],[</span><span class="mi">0</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">2</span><span class="p">]])</span><span class="o">.</span><span class="n">inverse</span><span class="p">()</span>
<span class="go">array([[ 0,  1,  2],</span>
<span class="go">       [-1,  0,  1],</span>
<span class="go">       [-1,  0,  2],</span>
<span class="go">       [-1, -1, -1],</span>
<span class="go">       [-1,  1,  2]], dtype=int32)</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="connectivity.Connectivity.nParents">
<code class="descname">nParents</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#connectivity.Connectivity.nParents" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the number of elements connected to each node.</p>
<p>Returns a 1-D int array with the number of elements connected
to each node. The length of the array is equal to the highest
node number + 1. Unused node numbers will have a count of zero.</p>
<p>Example:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">Connectivity</span><span class="p">([[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">],[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">4</span><span class="p">],[</span><span class="mi">0</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">2</span><span class="p">]])</span><span class="o">.</span><span class="n">nParents</span><span class="p">()</span>
<span class="go">array([3, 2, 2, 0, 2])</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="connectivity.Connectivity.connectedTo">
<code class="descname">connectedTo</code><span class="sig-paren">(</span><em>nodes</em>, <em>return_ncon=False</em><span class="sig-paren">)</span><a class="headerlink" href="#connectivity.Connectivity.connectedTo" title="Permalink to this definition">¶</a></dt>
<dd><p>Check if the elements are connected to the specified nodes.</p>
<ul class="simple">
<li><cite>nodes</cite>: a single node number or a list/array thereof,</li>
<li><cite>return_ncon</cite>: if True, also return the number of connections for
each element.</li>
</ul>
<p>Returns an int array with the numbers of the elements that contain
at least one of the specified nodes.
If <cite>return_ncon</cite> is True, also returns an int array giving the number
of connections for each connected element.</p>
<p>Example:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">A</span> <span class="o">=</span> <span class="n">Connectivity</span><span class="p">([[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">],[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">],[</span><span class="mi">0</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">2</span><span class="p">],[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">A</span><span class="o">.</span><span class="n">connectedTo</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span>
<span class="go">[0 2 3]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">A</span><span class="o">.</span><span class="n">connectedTo</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">],</span><span class="kc">True</span><span class="p">)</span>
<span class="go">(array([0, 1, 2, 3], dtype=int32), array([2, 3, 2, 2]))</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="connectivity.Connectivity.hits">
<code class="descname">hits</code><span class="sig-paren">(</span><em>nodes</em><span class="sig-paren">)</span><a class="headerlink" href="#connectivity.Connectivity.hits" title="Permalink to this definition">¶</a></dt>
<dd><p>Count the nodes from a list connected to the elements.</p>
<p><cite>nodes</cite>: a single node number or a list/array thereof</p>
<p>Returns an (nelems,) shaped int array with the number of nodes from
the list that are contained in each of the elements.</p>
<p>Note that this information can also be got from meth:<cite>connectedTo</cite>.
This method however exapnds the results to the full element set,
making it apt for use in selector expressions like:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="bp">self</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">hits</span><span class="p">(</span><span class="n">nodes</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="mi">2</span><span class="p">]</span>
</pre></div>
</div>
<p>Example:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">A</span> <span class="o">=</span> <span class="n">Connectivity</span><span class="p">([[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">],[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">],[</span><span class="mi">0</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">2</span><span class="p">],[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">A</span><span class="o">.</span><span class="n">hits</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="go">array([1, 0, 1, 1])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">A</span><span class="o">.</span><span class="n">hits</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">])</span>
<span class="go">array([2, 3, 2, 2])</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="connectivity.Connectivity.adjacency">
<code class="descname">adjacency</code><span class="sig-paren">(</span><em>kind='e'</em>, <em>mask=None</em><span class="sig-paren">)</span><a class="headerlink" href="#connectivity.Connectivity.adjacency" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a table of adjacent items.</p>
<p>Create an element adjacency table (kind=&#8217;e&#8217;) or node adjacency
table (kind=&#8217;n&#8217;).</p>
<p>An element <cite>i</cite> is said to be adjacent to element <cite>j</cite>, if the two
elements have at least one common node.</p>
<p>A node <cite>i</cite> is said to be adjacent to node <cite>j</cite>, if there is at least
one element containing both nodes.</p>
<p>Parameters:</p>
<ul>
<li><p class="first"><cite>kind</cite>: &#8216;e&#8217; or &#8216;n&#8217;, requesting resp. element or node adjacency.</p>
</li>
<li><p class="first"><cite>mask</cite>: Either None or a boolean array or index flagging the nodes
which are to be considered connectors between elements. If None,
all nodes are considered connections.
This option is only useful in the case <cite>kind</cite> == &#8216;e&#8217;. If you want to
use an element mask for the &#8216;n&#8217; case, just apply the (element) mask
beforehand:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="bp">self</span><span class="p">[</span><span class="n">mask</span><span class="p">]</span><span class="o">.</span><span class="n">adjacency</span><span class="p">(</span><span class="s1">&#39;n&#39;</span><span class="p">)</span>
</pre></div>
</div>
</li>
</ul>
<p>Returns:</p>
<p>An Adjacency array with shape (nr,nc),
where row <cite>i</cite> holds a sorted list of all the items that are
adjacent to item <cite>i</cite>, padded with -1 values to create an equal
list length for all items.</p>
<p>Example:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">Connectivity</span><span class="p">([[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">],[</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">],[</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">],[</span><span class="mi">0</span><span class="p">,</span><span class="mi">5</span><span class="p">]])</span><span class="o">.</span><span class="n">adjacency</span><span class="p">(</span><span class="s1">&#39;e&#39;</span><span class="p">)</span>
<span class="go">Adjacency([[ 1,  2,  3],</span>
<span class="go">       [-1,  0,  3],</span>
<span class="go">       [-1, -1,  0],</span>
<span class="go">       [-1,  0,  1]], dtype=int32)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Connectivity</span><span class="p">([[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">],[</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">],[</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">],[</span><span class="mi">0</span><span class="p">,</span><span class="mi">5</span><span class="p">]])</span><span class="o">.</span><span class="n">adjacency</span><span class="p">(</span><span class="s1">&#39;e&#39;</span><span class="p">,</span><span class="n">mask</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">5</span><span class="p">])</span>
<span class="go">Adjacency([[ 2],</span>
<span class="go">       [-1],</span>
<span class="go">       [ 0],</span>
<span class="go">       [-1]], dtype=int32)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Connectivity</span><span class="p">([[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">],[</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">],[</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">],[</span><span class="mi">0</span><span class="p">,</span><span class="mi">5</span><span class="p">]])</span><span class="o">.</span><span class="n">adjacency</span><span class="p">(</span><span class="s1">&#39;n&#39;</span><span class="p">)</span>
<span class="go">Adjacency([[ 1,  2,  5],</span>
<span class="go">       [-1,  0,  3],</span>
<span class="go">       [-1, -1,  0],</span>
<span class="go">       [-1, -1,  1],</span>
<span class="go">       [-1, -1, -1],</span>
<span class="go">       [-1, -1,  0]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Connectivity</span><span class="p">([[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">],[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">],[</span><span class="mi">2</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">]])</span><span class="o">.</span><span class="n">adjacency</span><span class="p">(</span><span class="s1">&#39;n&#39;</span><span class="p">)</span>
<span class="go">Adjacency([[-1,  1,  2,  3],</span>
<span class="go">       [-1,  0,  2,  3],</span>
<span class="go">       [ 0,  1,  4,  5],</span>
<span class="go">       [-1, -1,  0,  1],</span>
<span class="go">       [-1, -1,  2,  5],</span>
<span class="go">       [-1, -1,  2,  4]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Connectivity</span><span class="p">([[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">],[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">],[</span><span class="mi">2</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">]])[[</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">]]</span><span class="o">.</span><span class="n">adjacency</span><span class="p">(</span><span class="s1">&#39;n&#39;</span><span class="p">)</span>
<span class="go">Adjacency([[-1, -1,  1,  2],</span>
<span class="go">       [-1, -1,  0,  2],</span>
<span class="go">       [ 0,  1,  4,  5],</span>
<span class="go">       [-1, -1, -1, -1],</span>
<span class="go">       [-1, -1,  2,  5],</span>
<span class="go">       [-1, -1,  2,  4]])</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="connectivity.Connectivity.frontGenerator">
<code class="descname">frontGenerator</code><span class="sig-paren">(</span><em>startat=0</em>, <em>frontinc=1</em>, <em>partinc=1</em><span class="sig-paren">)</span><a class="headerlink" href="#connectivity.Connectivity.frontGenerator" title="Permalink to this definition">¶</a></dt>
<dd><p>Generator function returning the frontal elements.</p>
<p>This is a generator function and is normally not used directly,
but via the <a class="reference internal" href="#connectivity.Connectivity.frontWalk" title="connectivity.Connectivity.frontWalk"><code class="xref py py-meth docutils literal"><span class="pre">frontWalk()</span></code></a> method.</p>
<p>It returns an int array with a value for each element.
On the initial call, all values are -1, except for the elements
in the initial front, which get a value 0. At each call a new front
is created with all the elements that are connected to any of the
current front and which have not yet been visited. The new front
elements get a value equal to the last front&#8217;s value plus the
<cite>frontinc</cite>. If the front becomes empty and a new starting front is
created, the front value is extra incremented with <cite>partinc</cite>.</p>
<p>Parameters: see <a class="reference internal" href="#connectivity.Connectivity.frontWalk" title="connectivity.Connectivity.frontWalk"><code class="xref py py-meth docutils literal"><span class="pre">frontWalk()</span></code></a>.</p>
<p>Example:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">A</span> <span class="o">=</span> <span class="n">Adjacency</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span>
<span class="gp">... </span>                 <span class="p">[</span><span class="mi">3</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span>
<span class="gp">... </span>                 <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">],</span>
<span class="gp">... </span>                 <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span>
<span class="gp">... </span>                 <span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">A</span><span class="o">.</span><span class="n">frontGenerator</span><span class="p">():</span> <span class="nb">print</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>
<span class="go">[ 0 -1 -1 -1 -1]</span>
<span class="go">[ 0  1  1 -1 -1]</span>
<span class="go">[ 0  1  1  2 -1]</span>
<span class="go">[0 1 1 2 4]</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="connectivity.Connectivity.frontWalk">
<code class="descname">frontWalk</code><span class="sig-paren">(</span><em>startat=0</em>, <em>frontinc=1</em>, <em>partinc=1</em>, <em>maxval=-1</em><span class="sig-paren">)</span><a class="headerlink" href="#connectivity.Connectivity.frontWalk" title="Permalink to this definition">¶</a></dt>
<dd><p>Walks through the elements by their node front.</p>
<p>A frontal walk is executed starting from the given element(s).
A number of steps is executed, each step advancing the front
over a given number of single pass increments. The step number at
which an element is reached is recorded and returned.</p>
<p>Parameters:</p>
<ul class="simple">
<li><cite>startat</cite>: initial element numbers in the front. It can be a single
element number or a list of numbers.</li>
<li><cite>frontinc</cite>: increment for the front number on each frontal step.</li>
<li><cite>partinc</cite>: increment for the front number when the front</li>
<li><cite>maxval</cite>: maximum frontal value. If negative (default) the walk will
continue until all elements have been reached. If non-negative,
walking will stop as soon as the frontal value reaches this
maximum.</li>
</ul>
<p>Returns: an array of integers specifying for each element in which step
the element was reached by the walker.</p>
<p>Example:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">A</span> <span class="o">=</span> <span class="n">Adjacency</span><span class="p">([</span>
<span class="gp">... </span>      <span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span>  <span class="mi">1</span><span class="p">,</span>  <span class="mi">2</span><span class="p">,</span>  <span class="mi">3</span><span class="p">],</span>
<span class="gp">... </span>      <span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span>  <span class="mi">0</span><span class="p">,</span>  <span class="mi">2</span><span class="p">,</span>  <span class="mi">3</span><span class="p">],</span>
<span class="gp">... </span>      <span class="p">[</span> <span class="mi">0</span><span class="p">,</span>  <span class="mi">1</span><span class="p">,</span>  <span class="mi">4</span><span class="p">,</span>  <span class="mi">5</span><span class="p">],</span>
<span class="gp">... </span>      <span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span>  <span class="mi">0</span><span class="p">,</span>  <span class="mi">1</span><span class="p">],</span>
<span class="gp">... </span>      <span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span>  <span class="mi">2</span><span class="p">,</span>  <span class="mi">5</span><span class="p">],</span>
<span class="gp">... </span>      <span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span>  <span class="mi">2</span><span class="p">,</span>  <span class="mi">4</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">A</span><span class="o">.</span><span class="n">frontWalk</span><span class="p">())</span>
<span class="go">[0 1 1 1 2 2]</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="connectivity.Connectivity.front">
<code class="descname">front</code><span class="sig-paren">(</span><em>startat=0</em>, <em>add=False</em><span class="sig-paren">)</span><a class="headerlink" href="#connectivity.Connectivity.front" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the elements of the first node front.</p>
<p>Parameters:</p>
<ul class="simple">
<li><cite>startat</cite>: an element number or a list of element numbers.</li>
<li><cite>add</cite>: if True, the <cite>startat</cite> elements wil be included in the
return value. The default (false) will only return the elements
in the next front line.</li>
</ul>
<p>Returns a list of the elements that are connected to any of the nodes
that are part of the startat elements.</p>
<p>Note that this is equivalent to the first step of a <a class="reference internal" href="#connectivity.Connectivity.frontWalk" title="connectivity.Connectivity.frontWalk"><code class="xref py py-func docutils literal"><span class="pre">frontWalk()</span></code></a>
with the same startat elements, and could thus also be obtained from:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">where</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">frontWalk</span><span class="p">(</span><span class="n">startat</span><span class="p">,</span><span class="n">maxval</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
</pre></div>
</div>
<p>Here another implementation is used, which is more efficient for very
large models: it avoids the creation of the large array as returned
by frontWalk.</p>
</dd></dl>

<dl class="method">
<dt id="connectivity.Connectivity.selectNodes">
<code class="descname">selectNodes</code><span class="sig-paren">(</span><em>selector</em><span class="sig-paren">)</span><a class="headerlink" href="#connectivity.Connectivity.selectNodes" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a <a class="reference internal" href="#connectivity.Connectivity" title="connectivity.Connectivity"><code class="xref py py-class docutils literal"><span class="pre">Connectivity</span></code></a> containing subsets of the nodes.</p>
<p>Parameters:</p>
<ul class="simple">
<li><cite>selector</cite>: an object that can be converted to a 1-dim or 2-dim
int array. Examples are a tuple of local node numbers, or a list
of such tuples all having the same length.
Each row of <cite>selector</cite> holds a list of the local node numbers that
should be retained in the new Connectivity table.</li>
</ul>
<p>Returns:</p>
<blockquote>
<div>A <a class="reference internal" href="#connectivity.Connectivity" title="connectivity.Connectivity"><code class="xref py py-class docutils literal"><span class="pre">Connectivity</span></code></a> object with shape
<code class="docutils literal"><span class="pre">(self.nelems*selector.nelems,selector.nplex)</span></code>.
This function does not collapse the duplicate elements. The eltype
of the result is equal to that of the selector, possibly None.</div></blockquote>
<p>Example:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">Connectivity</span><span class="p">([[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">],[</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">],[</span><span class="mi">0</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">2</span><span class="p">]])</span><span class="o">.</span><span class="n">selectNodes</span><span class="p">([[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">],[</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">]])</span>
<span class="go">Connectivity([[0, 1],</span>
<span class="go">       [0, 2],</span>
<span class="go">       [0, 2],</span>
<span class="go">       [0, 1],</span>
<span class="go">       [0, 3],</span>
<span class="go">       [0, 2]])</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="connectivity.Connectivity.insertLevel">
<code class="descname">insertLevel</code><span class="sig-paren">(</span><em>selector</em>, <em>permutations=True</em><span class="sig-paren">)</span><a class="headerlink" href="#connectivity.Connectivity.insertLevel" title="Permalink to this definition">¶</a></dt>
<dd><p>Insert an extra hierarchical level in a Connectivity table.</p>
<p>A Connectivity table identifies higher hierarchical entities in
function of lower ones. This method inserts an extra level in the
hierarchy.
For example, if you have volumes defined in function of points,
you can insert an intermediate level of edges, or faces.
Multiple intermediate level entities may be created from each
element.</p>
<p>Parameters:</p>
<ul>
<li><p class="first"><cite>selector</cite>: an object that can be converted to a 1-dim or 2-dim
integer array. Examples are a tuple of local node numbers, or a list
of such tuples all having the same length.
Each row of <cite>selector</cite> holds a list of the local node numbers that
should be retained in the new Connectivity table.</p>
</li>
<li><p class="first"><cite>permutations</cite>: <cite>bool</cite> . If True, rows which are permutations of
the same data are considered equal.</p>
<p>If the Connectivity has an element type, selector can also be a
single integer specifying one of the hierarchical levels of element
entities (See the Element class). In that case the selector is
constructed automatically from self.eltype.getEntities(selector).</p>
</li>
</ul>
<p>Returns:</p>
<ul class="simple">
<li><cite>hi</cite>: a <a class="reference internal" href="#connectivity.Connectivity" title="connectivity.Connectivity"><code class="xref py py-class docutils literal"><span class="pre">Connectivity</span></code></a> defining the original elements
in function of the intermediate level ones,</li>
<li><cite>lo</cite>: a <a class="reference internal" href="#connectivity.Connectivity" title="connectivity.Connectivity"><code class="xref py py-class docutils literal"><span class="pre">Connectivity</span></code></a> defining the intermediate level
items in function of the lowest level ones (the original nodes).
If the <cite>selector</cite> has an <cite>eltype</cite> attribute, then <cite>lo</cite> will inherit
the same <cite>eltype</cite> value.</li>
</ul>
<p>All intermediate level items that consist of the same set of nodes
in any permutation order and with any multiplicity, are considered
identical and are collapsed into single items if permutations is <cite>True</cite>.
The resulting node numbering of the created intermediate entities
(the <cite>lo</cite> return value) respects the numbering order of the original
elements and applied the selector, but it is undefined which of the
collapsed sequences is returned.</p>
<p>Because the precise order of the data in the collapsed rows is lost,
it is in general not possible to restore the exact original table
from the two result tables.
See however <code class="xref py py-meth docutils literal"><span class="pre">Mesh.getBorder()</span></code> for an application where an
inverse operation is possible, because the border only contains
unique rows.
See also <code class="xref py py-meth docutils literal"><span class="pre">Mesh.combine()</span></code>, which is an almost inverse operation
for the general case, if the selector is complete.
The resulting rows may however be permutations of the original.</p>
<p>Example:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">Connectivity</span><span class="p">([[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">],[</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">],[</span><span class="mi">0</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">2</span><span class="p">]])</span><span class="o">.</span>          <span class="n">insertLevel</span><span class="p">([[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">],[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">],[</span><span class="mi">2</span><span class="p">,</span><span class="mi">0</span><span class="p">]])</span>
<span class="go">(Connectivity([[0, 3, 1],</span>
<span class="go">       [1, 3, 0],</span>
<span class="go">       [2, 4, 1]]), Connectivity([[0, 1],</span>
<span class="go">       [2, 0],</span>
<span class="go">       [0, 3],</span>
<span class="go">       [1, 2],</span>
<span class="go">       [3, 2]]))</span>
<span class="go"> &gt;&gt;&gt; Connectivity([[0,1,2,3]]).insertLevel([[0,1,2],[1,2,3],[0,1,1],[0,0,1],[1,0,0]])</span>
<span class="go"> (Connectivity([[1, 2, 0, 0, 0]]), Connectivity([[0, 1, 1],</span>
<span class="go">        [0, 1, 2],</span>
<span class="go">        [1, 2, 3]]))</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="connectivity.Connectivity.combine">
<code class="descname">combine</code><span class="sig-paren">(</span><em>lo</em><span class="sig-paren">)</span><a class="headerlink" href="#connectivity.Connectivity.combine" title="Permalink to this definition">¶</a></dt>
<dd><p>Combine two hierarchical Connectivity levels to a single one.</p>
<p>self and lo are two hierarchical Connectivity tables, representing
higher and lower level respectively. This means that the elements
of self hold numbers which point into lo to obtain the lowest level
items.</p>
<p><em>In the current implementation, the plexitude of lo should be 2!</em></p>
<p>As an example, in a structure of triangles, hi could represent
triangles defined by 3 edges and lo could represent edges defined
by 2 vertices. This method will then result in a table
with plexitude 3 defining the triangles in function of the vertices.</p>
<p>This is the inverse operation of <a class="reference internal" href="#connectivity.Connectivity.insertLevel" title="connectivity.Connectivity.insertLevel"><code class="xref py py-meth docutils literal"><span class="pre">insertLevel()</span></code></a> with a selector
which is complete.
The algorithm only works if all vertex numbers of an element are
unique.</p>
<p>Example:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">hi</span><span class="p">,</span><span class="n">lo</span> <span class="o">=</span> <span class="n">Connectivity</span><span class="p">([[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">],[</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">],[</span><span class="mi">0</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">2</span><span class="p">]])</span><span class="o">.</span>          <span class="n">insertLevel</span><span class="p">([[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">],[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">],[</span><span class="mi">2</span><span class="p">,</span><span class="mi">0</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">hi</span><span class="o">.</span><span class="n">combine</span><span class="p">(</span><span class="n">lo</span><span class="p">)</span>
<span class="go">Connectivity([[0, 1, 2],</span>
<span class="go">       [0, 2, 1],</span>
<span class="go">       [0, 3, 2]])</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="connectivity.Connectivity.resolve">
<code class="descname">resolve</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#connectivity.Connectivity.resolve" title="Permalink to this definition">¶</a></dt>
<dd><p>Resolve the connectivity into plex-2 connections.</p>
<p>Creates a Connectivity table with a plex-2 (edge) connection
between any two nodes that are connected to a common element.</p>
<p>There is no point in resolving a plexitude 2 structure.
Plexitudes lower than 2 can not be resolved.</p>
<p>Returns a plex-2 Connectivity with all connections between node
pairs. In each element the nodes are sorted.</p>
<p>Example:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">([</span> <span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">combinations</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span><span class="mi">2</span><span class="p">)</span> <span class="p">])</span>
<span class="go">[(0, 1), (0, 2), (1, 2)]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Connectivity</span><span class="p">([[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">],[</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">],[</span><span class="mi">0</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">2</span><span class="p">]])</span><span class="o">.</span><span class="n">resolve</span><span class="p">()</span>
<span class="go">Connectivity([[0, 1],</span>
<span class="go">       [0, 2],</span>
<span class="go">       [0, 3],</span>
<span class="go">       [1, 2],</span>
<span class="go">       [2, 3]])</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="connectivity.Connectivity.sharedNodes">
<code class="descname">sharedNodes</code><span class="sig-paren">(</span><em>elist=None</em><span class="sig-paren">)</span><a class="headerlink" href="#connectivity.Connectivity.sharedNodes" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the list of nodes shared by all elements in elist</p>
<p>Parameters:</p>
<ul class="simple">
<li><cite>elist</cite>: an integer list-like with element numbers. If not specified,
all elements are considered.</li>
</ul>
<p>Returns a 1-D integer array with the list of nodes that are
common to all elements in the specified list. This array may be
empty.</p>
<p>Example:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">a</span> <span class="o">=</span> <span class="n">Connectivity</span><span class="p">([[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">],[</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">],[</span><span class="mi">0</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">2</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span><span class="o">.</span><span class="n">sharedNodes</span><span class="p">()</span>
<span class="go">Connectivity([0, 2])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span><span class="o">.</span><span class="n">sharedNodes</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
<span class="go">Connectivity([0, 1, 2])</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="connectivity.Connectivity.replic">
<code class="descname">replic</code><span class="sig-paren">(</span><em>n</em>, <em>inc</em><span class="sig-paren">)</span><a class="headerlink" href="#connectivity.Connectivity.replic" title="Permalink to this definition">¶</a></dt>
<dd><p>Repeat a Connectivity with increasing node numbers.</p>
<p>Parameters:</p>
<ul class="simple">
<li><cite>n</cite>: integer: number of copies to make</li>
<li><cite>inc</cite>: integer: increment in node numbers for each copy</li>
</ul>
<p>Returns a Connectivity with the concatenation of <cite>n</cite> replicas of
<cite>self</cite>, where the first replica is identical to self and each
next one has its node numbers increased by <cite>inc</cite>.</p>
<p>Example:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">Connectivity</span><span class="p">([[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">],[</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">]])</span><span class="o">.</span><span class="n">replic</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">4</span><span class="p">)</span>
<span class="go">Connectivity([[0, 1, 2],</span>
<span class="go">       [0, 2, 3],</span>
<span class="go">       [4, 5, 6],</span>
<span class="go">       [4, 6, 7]])</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="connectivity.Connectivity.extrude">
<code class="descname">extrude</code><span class="sig-paren">(</span><em>nnod</em>, <em>degree</em><span class="sig-paren">)</span><a class="headerlink" href="#connectivity.Connectivity.extrude" title="Permalink to this definition">¶</a></dt>
<dd><p>Extrude a Connectivity to a higher level Connectivity.</p>
<p>This method is only available if the Connectivity has an
element type and the element type is extrudable. See
<a class="reference internal" href="elements.html#module-elements" title="elements: Definition of elements."><code class="xref py py-mod docutils literal"><span class="pre">elements</span></code></a> for more details.</p>
<p>Parameters:</p>
<ul class="simple">
<li><cite>nnod</cite>: integer: should be larger than the highest node number in self</li>
<li><cite>degree</cite>: integer: degree of extrusion (currently 1 or 2)</li>
</ul>
<p>The extrusion adds <cite>degree</cite> planes of nodes, each with an node increment
<cite>nnod</cite>, to the original Connectivity <cite>e</cite> and then selects the target
nodes from it as defined by the <cite>self.eltype.extruded[degree]</cite> value.</p>
<p>Returns a Connectivity for the extruded element.</p>
<p>Example:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pyformex.elements</span> <span class="k">import</span> <span class="n">Line2</span><span class="p">,</span><span class="n">Line3</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span> <span class="o">=</span> <span class="n">Connectivity</span><span class="p">([[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">],[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">]],</span><span class="n">eltype</span><span class="o">=</span><span class="n">Line2</span><span class="p">)</span><span class="o">.</span><span class="n">extrude</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
<span class="go">[[0 1 4 3]</span>
<span class="go"> [1 2 5 4]]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">a</span><span class="o">.</span><span class="n">eltype</span><span class="o">.</span><span class="n">name</span><span class="p">())</span>
<span class="go">quad4</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span> <span class="o">=</span> <span class="n">Connectivity</span><span class="p">([[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">],[</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">]],</span><span class="n">eltype</span><span class="o">=</span><span class="n">Line3</span><span class="p">)</span><span class="o">.</span><span class="n">extrude</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
<span class="go">[[ 0  2 10  8  1  6  9  4  5]</span>
<span class="go"> [ 0  3 11  8  2  7 10  4  6]]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">a</span><span class="o">.</span><span class="n">eltype</span><span class="o">.</span><span class="n">name</span><span class="p">())</span>
<span class="go">quad9</span>
</pre></div>
</div>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="functions-defined-in-module-connectivity">
<h2>9.2. Functions defined in module connectivity<a class="headerlink" href="#functions-defined-in-module-connectivity" title="Permalink to this headline">¶</a></h2>
<dl class="function">
<dt id="connectivity.findConnectedLineElems">
<code class="descclassname">connectivity.</code><code class="descname">findConnectedLineElems</code><span class="sig-paren">(</span><em>elems</em><span class="sig-paren">)</span><a class="headerlink" href="#connectivity.findConnectedLineElems" title="Permalink to this definition">¶</a></dt>
<dd><p>Find a single path of connected line elems.</p>
<p>This function is intended as a helper function for
<a class="reference internal" href="#connectivity.connectedLineElems" title="connectivity.connectedLineElems"><code class="xref py py-func docutils literal"><span class="pre">connectedLineElems()</span></code></a>. It should probably not be used directly,
because, as a side-effect, it changes the data in the <cite>elems</cite> argument.
<a class="reference internal" href="#connectivity.connectedLineElems" title="connectivity.connectedLineElems"><code class="xref py py-func docutils literal"><span class="pre">connectedLineElems()</span></code></a> does not have this inconvenience.</p>
<p>The function searches a Connectivity table for a chain of elements
in which the first node of all but the first element is equal to the
last node of the previous element. To create such a chain, elements may
be reordered and the node sequence of an element may be reversed.</p>
<p>Parameters:</p>
<ul class="simple">
<li><cite>elems</cite>: Connectivity-like. Any plexitude is allowed, but only the
first and the last column are relevant.</li>
</ul>
<p>Returns:</p>
<ul class="simple">
<li><cite>con</cite>: a Connectivity with the same shape as the input Connectivity
<cite>elems</cite>, holding a single chain extracted from the input and filled
with -1 for the remainder (if any). The chain will not necessarily
be the longest path. It will however at least contain the first element
of the input table.</li>
<li><cite>inv</cite>: an int array with two columns and number of rows equal to that of
<cite>con</cite>. The first column holds the row number in <cite>elems</cite> of the entries
in <cite>con</cite>. The second column holds a value +1 or -1, flagging whether
the element is traversed in original direction (+1) in the chain or in
the reverse direction (-1).</li>
</ul>
<p>Example:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">con</span><span class="p">,</span><span class="n">inv</span> <span class="o">=</span> <span class="n">findConnectedLineElems</span><span class="p">([[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">],[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">],[</span><span class="mi">0</span><span class="p">,</span><span class="mi">4</span><span class="p">],[</span><span class="mi">4</span><span class="p">,</span><span class="mi">2</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">con</span><span class="p">)</span>
<span class="go">[[0 1]</span>
<span class="go"> [1 2]</span>
<span class="go"> [2 4]</span>
<span class="go"> [4 0]]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">inv</span><span class="p">)</span>
<span class="go">[[ 0  1]</span>
<span class="go"> [ 1  1]</span>
<span class="go"> [ 3 -1]</span>
<span class="go"> [ 2 -1]]</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">con</span><span class="p">,</span><span class="n">inv</span> <span class="o">=</span> <span class="n">findConnectedLineElems</span><span class="p">([[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">],[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">],[</span><span class="mi">0</span><span class="p">,</span><span class="mi">4</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">con</span><span class="p">)</span>
<span class="go">[[2 1]</span>
<span class="go"> [1 0]</span>
<span class="go"> [0 4]]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">inv</span><span class="p">)</span>
<span class="go">[[ 1 -1]</span>
<span class="go"> [ 0 -1]</span>
<span class="go"> [ 2  1]]</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">C</span> <span class="o">=</span> <span class="n">Connectivity</span><span class="p">([[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">],[</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">],[</span><span class="mi">0</span><span class="p">,</span><span class="mi">3</span><span class="p">],[</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">con</span><span class="p">,</span><span class="n">inv</span> <span class="o">=</span> <span class="n">findConnectedLineElems</span><span class="p">(</span><span class="n">C</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">con</span><span class="p">)</span>
<span class="go">[[ 1  0]</span>
<span class="go"> [ 0  2]</span>
<span class="go"> [-1 -1]</span>
<span class="go"> [-1 -1]]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">inv</span><span class="p">)</span>
<span class="go">[[ 0 -1]</span>
<span class="go"> [ 1  1]</span>
<span class="go"> [-1  0]</span>
<span class="go"> [-1  0]]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">C</span><span class="p">)</span>
<span class="go">[[-1 -1]</span>
<span class="go"> [-1 -1]</span>
<span class="go"> [ 0  3]</span>
<span class="go"> [ 4  5]]</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="connectivity.connectedLineElems">
<code class="descclassname">connectivity.</code><code class="descname">connectedLineElems</code><span class="sig-paren">(</span><em>elems</em>, <em>return_indices=False</em><span class="sig-paren">)</span><a class="headerlink" href="#connectivity.connectedLineElems" title="Permalink to this definition">¶</a></dt>
<dd><p>Partition a collection of line segments into connected polylines.</p>
<p>The input argument is a (nelems,2) shaped array of integers.
Each row holds the two vertex numbers of a single line segment.</p>
<p>The return value is a list of Connectivity tables of plexitude 2.
The line elements of each Connectivity are ordered to form a continuous
connected segment, i.e. the first vertex of each line element in a
table is equal to the last vertex of the previous element.
The connectivity tables are sorted in order of decreasing length.</p>
<p>If return_indices = True, a second list of tables is returned, with
the same shape as those in the first list. The tables of the second
list contain in the first column the original element number of the
entries, and in the second column a value +1 or -1 depending on
whether the element traversal in the connected segment is in the
original direction (+1) or the reverse (-1).</p>
<p>Example:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">connectedLineElems</span><span class="p">([[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">],[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">],[</span><span class="mi">0</span><span class="p">,</span><span class="mi">4</span><span class="p">],[</span><span class="mi">4</span><span class="p">,</span><span class="mi">2</span><span class="p">]])</span>
<span class="go">[Connectivity([[0, 1],</span>
<span class="go">       [1, 2],</span>
<span class="go">       [2, 4],</span>
<span class="go">       [4, 0]])]</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">connectedLineElems</span><span class="p">([[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">],[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">],[</span><span class="mi">0</span><span class="p">,</span><span class="mi">4</span><span class="p">]])</span>
<span class="go">[Connectivity([[2, 1],</span>
<span class="go">       [1, 0],</span>
<span class="go">       [0, 4]])]</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">connectedLineElems</span><span class="p">([[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">],[</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">],[</span><span class="mi">0</span><span class="p">,</span><span class="mi">3</span><span class="p">],[</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">]])</span>
<span class="go">[Connectivity([[1, 0],</span>
<span class="go">       [0, 2]]), Connectivity([[4, 5]]), Connectivity([[0, 3]])]</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">connectedLineElems</span><span class="p">([[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">],[</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">],[</span><span class="mi">0</span><span class="p">,</span><span class="mi">3</span><span class="p">],[</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">]])</span>
<span class="go">[Connectivity([[1, 0],</span>
<span class="go">       [0, 2]]), Connectivity([[4, 5]]), Connectivity([[0, 3]])]</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">connectedLineElems</span><span class="p">([[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">],[</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">],[</span><span class="mi">0</span><span class="p">,</span><span class="mi">3</span><span class="p">],[</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">]],</span><span class="kc">True</span><span class="p">)</span>
<span class="go">([Connectivity([[1, 0],</span>
<span class="go">       [0, 2]]), Connectivity([[4, 5]]), Connectivity([[0, 3]])], [array([[ 0, -1],</span>
<span class="go">       [ 1,  1]], dtype=int32), array([[3, 1]], dtype=int32), array([[2, 1]], dtype=int32)])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">connectedLineElems</span><span class="p">([[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">],[</span><span class="mi">2</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">3</span><span class="p">],[</span><span class="mi">0</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">1</span><span class="p">],[</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">2</span><span class="p">]])</span>
<span class="go">[Connectivity([[3, 0, 2],</span>
<span class="go">       [2, 1, 0],</span>
<span class="go">       [0, 3, 1]]), Connectivity([[4, 5, 2]])]</span>
</pre></div>
</div>
<p>Obviously, from the input elems table and the second return value,
the first return value could be reconstructed:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">first</span> <span class="o">=</span> <span class="p">[</span>
    <span class="n">where</span><span class="p">(</span><span class="n">i</span><span class="p">[:,</span><span class="o">-</span><span class="mi">1</span><span class="p">:]</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">,</span> <span class="n">elems</span><span class="p">[</span><span class="n">i</span><span class="p">[:,</span><span class="mi">0</span><span class="p">]],</span> <span class="n">elems</span><span class="p">[</span><span class="n">i</span><span class="p">[:,</span><span class="mi">0</span><span class="p">],::</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">second</span>
<span class="p">]</span>
</pre></div>
</div>
<p>But since the construction of the first list is required by the algorithm,
it is returned anyway.</p>
</dd></dl>

<dl class="function">
<dt id="connectivity.adjacencyArrays">
<code class="descclassname">connectivity.</code><code class="descname">adjacencyArrays</code><span class="sig-paren">(</span><em>elems</em>, <em>nsteps=1</em><span class="sig-paren">)</span><a class="headerlink" href="#connectivity.adjacencyArrays" title="Permalink to this definition">¶</a></dt>
<dd><p>Create adjacency arrays for 2-node elements.</p>
<p>elems is a (nr,2) shaped integer array.
The result is a list of adjacency arrays, where row i of adjacency array j
holds a sorted list of the nodes that are connected to node i via a shortest
path of j elements, padded with -1 values to create an equal list length
for all nodes.
This is: [adj0, adj1, ..., adjj, ... , adjn] with n=nsteps.</p>
<p>Example:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">adjacencyArrays</span><span class="p">([[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">],[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">],[</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">],[</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">],[</span><span class="mi">4</span><span class="p">,</span><span class="mi">0</span><span class="p">]],</span><span class="mi">3</span><span class="p">)</span>
<span class="go">[array([[0],</span>
<span class="go">       [1],</span>
<span class="go">       [2],</span>
<span class="go">       [3],</span>
<span class="go">       [4]]), Adjacency([[1, 4],</span>
<span class="go">       [0, 2],</span>
<span class="go">       [1, 3],</span>
<span class="go">       [2, 4],</span>
<span class="go">       [0, 3]]), array([[2, 3],</span>
<span class="go">       [3, 4],</span>
<span class="go">       [0, 4],</span>
<span class="go">       [0, 1],</span>
<span class="go">       [1, 2]]), array([], shape=(5, 0), dtype=int64)]</span>
</pre></div>
</div>
</dd></dl>

</div>
</div>


          </div>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="elements.html" title="10. elements — Definition of elements."
             >next</a> |</li>
        <li class="right" >
          <a href="geometry.html" title="8. geometry — A generic interface to the Coords transformation methods"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../index.html">pyFormex 1.0.2-a6 documentation</a> &gt;</li>
          <li class="nav-item nav-item-1"><a href="../refman.html" >pyFormex reference manual</a> &gt;</li> 
      </ul>
    </div>
    <div class="footer">
    <span class="left">
        &copy; Copyright 2004-2015, Benedict Verhegghe.
    </span>
      Last updated on Sep 08, 2016.
    <span class="right">
      Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 1.4.5.
    </span>
    </div>
  </body>
</html>